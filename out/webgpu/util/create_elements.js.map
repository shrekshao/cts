{"version":3,"sources":["../../../src/webgpu/util/create_elements.ts"],"names":["unreachable","kAllCanvasTypes","kValidCanvasContextIds","canCopyFromCanvasContext","contextName","createCanvas","test","canvasType","width","height","canvas","document","createOnscreenCanvas","skip","OffscreenCanvas","createOffscreenCanvas","createElement"],"mappings":";AAAA;AACA,YAASA,WAAT,QAA4B,2BAA5B;AAEA,OAAO,MAAMC,eAAe,GAAG,CAAC,UAAD,EAAa,WAAb,CAAxB;;;AAGP;AACA;AACA;AACA,OAAO,MAAMC,sBAAsB,GAAG;AACpC,IADoC;AAEpC,gBAFoC;AAGpC,OAHoC;AAIpC,QAJoC;AAKpC,QALoC,CAA/B;;;;AASP;AACA,OAAO,SAASC,wBAAT,CAAkCC,WAAlC,EAA8D;AACnE,UAAQA,WAAR;AACE,SAAK,IAAL;AACA,SAAK,OAAL;AACA,SAAK,QAAL;AACA,SAAK,QAAL;AACE,aAAO,IAAP;AACF;AACE,aAAO,KAAP,CAPJ;;AASD;;AAED;AACA,OAAO,SAASC,YAAT;AACLC,IADK;AAELC,UAFK;AAGLC,KAHK;AAILC,MAJK;AAKgC;AACrC,MAAIC,MAAJ;AACA,MAAIH,UAAU,KAAK,UAAnB,EAA+B;AAC7B,QAAI,OAAOI,QAAP,KAAoB,WAAxB,EAAqC;AACnCD,MAAAA,MAAM,GAAGE,oBAAoB,CAACN,IAAD,EAAOE,KAAP,EAAcC,MAAd,CAA7B;AACD,KAFD,MAEO;AACLH,MAAAA,IAAI,CAACO,IAAL,CAAU,iCAAV;AACD;AACF,GAND,MAMO,IAAIN,UAAU,KAAK,WAAnB,EAAgC;AACrC,QAAI,OAAOO,eAAP,KAA2B,WAA/B,EAA4C;AAC1CJ,MAAAA,MAAM,GAAGK,qBAAqB,CAACT,IAAD,EAAOE,KAAP,EAAcC,MAAd,CAA9B;AACD,KAFD,MAEO;AACLH,MAAAA,IAAI,CAACO,IAAL,CAAU,kCAAV;AACD;AACF,GANM,MAMA;AACLb,IAAAA,WAAW;AACZ;;AAED,SAAOU,MAAP;AACD;;AAED;AACA,OAAO,SAASE,oBAAT;AACLN,IADK;AAELE,KAFK;AAGLC,MAHK;AAIc;AACnB,MAAIC,MAAJ;AACA,MAAI,OAAOC,QAAP,KAAoB,WAAxB,EAAqC;AACnCD,IAAAA,MAAM,GAAGC,QAAQ,CAACK,aAAT,CAAuB,QAAvB,CAAT;AACAN,IAAAA,MAAM,CAACF,KAAP,GAAeA,KAAf;AACAE,IAAAA,MAAM,CAACD,MAAP,GAAgBA,MAAhB;AACD,GAJD,MAIO;AACLH,IAAAA,IAAI,CAACO,IAAL,CAAU,iCAAV;AACD;AACD,SAAOH,MAAP;AACD;;AAED;AACA,OAAO,SAASK,qBAAT;AACLT,IADK;AAELE,KAFK;AAGLC,MAHK;AAIY;AACjB,MAAI,OAAOK,eAAP,KAA2B,WAA/B,EAA4C;AAC1CR,IAAAA,IAAI,CAACO,IAAL,CAAU,kCAAV;AACD;;AAED,SAAO,IAAIC,eAAJ,CAAoBN,KAApB,EAA2BC,MAA3B,CAAP;AACD","sourcesContent":["import { Fixture } from '../../common/framework/fixture.js';\nimport { unreachable } from '../../common/util/util.js';\n\nexport const kAllCanvasTypes = ['onscreen', 'offscreen'] as const;\nexport type CanvasType = typeof kAllCanvasTypes[number];\n\n/** Valid contextId for HTMLCanvasElement/OffscreenCanvas,\n *  spec: https://html.spec.whatwg.org/multipage/canvas.html#dom-canvas-getcontext\n */\nexport const kValidCanvasContextIds = [\n  '2d',\n  'bitmaprenderer',\n  'webgl',\n  'webgl2',\n  'webgpu',\n] as const;\nexport type CanvasContext = typeof kValidCanvasContextIds[number];\n\n/** Helper(s) to determine if context is copyable. */\nexport function canCopyFromCanvasContext(contextName: CanvasContext) {\n  switch (contextName) {\n    case '2d':\n    case 'webgl':\n    case 'webgl2':\n    case 'webgpu':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/** Create HTMLCanvas/OffscreenCanvas. */\nexport function createCanvas(\n  test: Fixture,\n  canvasType: 'onscreen' | 'offscreen',\n  width: number,\n  height: number\n): HTMLCanvasElement | OffscreenCanvas {\n  let canvas: HTMLCanvasElement | OffscreenCanvas;\n  if (canvasType === 'onscreen') {\n    if (typeof document !== 'undefined') {\n      canvas = createOnscreenCanvas(test, width, height);\n    } else {\n      test.skip('Cannot create HTMLCanvasElement');\n    }\n  } else if (canvasType === 'offscreen') {\n    if (typeof OffscreenCanvas !== 'undefined') {\n      canvas = createOffscreenCanvas(test, width, height);\n    } else {\n      test.skip('Cannot create an OffscreenCanvas');\n    }\n  } else {\n    unreachable();\n  }\n\n  return canvas;\n}\n\n/** Create HTMLCanvasElement. */\nexport function createOnscreenCanvas(\n  test: Fixture,\n  width: number,\n  height: number\n): HTMLCanvasElement {\n  let canvas: HTMLCanvasElement;\n  if (typeof document !== 'undefined') {\n    canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n  } else {\n    test.skip('Cannot create HTMLCanvasElement');\n  }\n  return canvas;\n}\n\n/** Create OffscreenCanvas. */\nexport function createOffscreenCanvas(\n  test: Fixture,\n  width: number,\n  height: number\n): OffscreenCanvas {\n  if (typeof OffscreenCanvas === 'undefined') {\n    test.skip('OffscreenCanvas is not supported');\n  }\n\n  return new OffscreenCanvas(width, height);\n}\n"],"file":"create_elements.js"}