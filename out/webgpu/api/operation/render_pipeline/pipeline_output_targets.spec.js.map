{"version":3,"file":"pipeline_output_targets.spec.js","names":["description","makeTestGroup","range","kRenderableColorTextureFormats","kTextureFormatInfo","GPUTest","getFragmentShaderCodeWithOutput","getPlainTypeInfo","kTexelRepresentationInfo","TexelView","textureContentIsOKByT2B","kVertexShader","g","attachmentsIntWriteValues","R","G","B","A","attachmentsFloatWriteValues","test","desc","params","u","combine","beginSubcases","expand","p","attachmentCount","i","beforeAllSubcases","t","info","format","selectDeviceOrSkipTestCase","feature","fn","emptyAttachmentId","componentCount","componentOrder","length","writeValues","sampleType","renderTargets","device","createTexture","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","COPY_SRC","RENDER_ATTACHMENT","pipeline","createRenderPipeline","layout","vertex","module","createShaderModule","code","entryPoint","fragment","values","plainType","targets","primitive","topology","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","createView","storeOp","clearValue","r","b","a","loadOp","setPipeline","draw","end","queue","submit","finish","promises","undefined","texture","expTexelView","fromTexelsAsColors","coords","maxIntDiff","maxDiffULPsForNormFormat","maxDiffULPsForFloatFormat","eventualExpectOK","Promise","all","filter","x","renderTarget","expectSingleColor","exp","combineWithParams","_result","output","colorSrcFactor","colorDstFactor","alphaSrcFactor","alphaDstFactor","blend","color","srcFactor","dstFactor","operation","alpha"],"sources":["../../../../../src/webgpu/api/operation/render_pipeline/pipeline_output_targets.spec.ts"],"sourcesContent":["export const description = `\n- Test pipeline outputs with different color attachment number, formats, component counts, etc.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { range } from '../../../../common/util/util.js';\nimport { kRenderableColorTextureFormats, kTextureFormatInfo } from '../../../capability_info.js';\nimport { GPUTest } from '../../../gpu_test.js';\nimport { getFragmentShaderCodeWithOutput, getPlainTypeInfo } from '../../../util/shader.js';\nimport { kTexelRepresentationInfo } from '../../../util/texture/texel_data.js';\nimport { TexelView } from '../../../util/texture/texel_view.js';\nimport { textureContentIsOKByT2B } from '../../../util/texture/texture_ok.js';\n\nconst kVertexShader = `\n@vertex fn main(\n@builtin(vertex_index) VertexIndex : u32\n) -> @builtin(position) vec4<f32> {\n  var pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n      vec2<f32>(-1.0, -3.0),\n      vec2<f32>(3.0, 1.0),\n      vec2<f32>(-1.0, 1.0));\n  return vec4<f32>(pos[VertexIndex], 0.0, 1.0);\n}\n`;\n\nexport const g = makeTestGroup(GPUTest);\n\n// Values to write into each attachment\n// We make values different for each attachment index and each channel\n// to make sure they didn't get mixed up\nconst attachmentsIntWriteValues = [\n  { R: 1, G: 2, B: 3, A: 4 },\n  { R: 5, G: 6, B: 7, A: 8 },\n  { R: 9, G: 10, B: 11, A: 12 },\n  { R: 13, G: 14, B: 15, A: 16 },\n];\nconst attachmentsFloatWriteValues = [\n  { R: 0.12, G: 0.34, B: 0.56, A: 0 },\n  { R: 0.78, G: 0.9, B: 0.19, A: 1 },\n  { R: 0.28, G: 0.37, B: 0.46, A: 0.3 },\n  { R: 0.55, G: 0.64, B: 0.73, A: 1 },\n];\n\ng.test('color,attachments')\n  .desc(`Test that pipeline with sparse color attachments write values correctly.`)\n  .params(u =>\n    u\n      .combine('format', kRenderableColorTextureFormats)\n      .beginSubcases()\n      .combine('attachmentCount', [2, 3, 4])\n      .expand('emptyAttachmentId', p => range(p.attachmentCount, i => i))\n  )\n  .beforeAllSubcases(t => {\n    const info = kTextureFormatInfo[t.params.format];\n    t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const { format, attachmentCount, emptyAttachmentId } = t.params;\n    const componentCount = kTexelRepresentationInfo[format].componentOrder.length;\n    const info = kTextureFormatInfo[format];\n\n    const writeValues =\n      info.sampleType === 'sint' || info.sampleType === 'uint'\n        ? attachmentsIntWriteValues\n        : attachmentsFloatWriteValues;\n\n    const renderTargets = range(attachmentCount, () =>\n      t.device.createTexture({\n        format,\n        size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n        usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n      })\n    );\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: getFragmentShaderCodeWithOutput(\n            range(attachmentCount, i =>\n              i === emptyAttachmentId\n                ? null\n                : {\n                    values: [\n                      writeValues[i].R,\n                      writeValues[i].G,\n                      writeValues[i].B,\n                      writeValues[i].A,\n                    ],\n                    plainType: getPlainTypeInfo(info.sampleType),\n                    componentCount,\n                  }\n            )\n          ),\n        }),\n        entryPoint: 'main',\n        targets: range(attachmentCount, i => (i === emptyAttachmentId ? null : { format })),\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: range(attachmentCount, i =>\n        i === emptyAttachmentId\n          ? null\n          : {\n              view: renderTargets[i].createView(),\n              storeOp: 'store',\n              clearValue: { r: 0.5, g: 0.5, b: 0.5, a: 0.5 },\n              loadOp: 'clear',\n            }\n      ),\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    const promises = range(attachmentCount, i => {\n      if (i === emptyAttachmentId) {\n        return undefined;\n      }\n      return textureContentIsOKByT2B(\n        t,\n        { texture: renderTargets[i] },\n        [1, 1, 1],\n        {\n          expTexelView: TexelView.fromTexelsAsColors(format, coords => writeValues[i]),\n        },\n        {\n          maxIntDiff: 0,\n          maxDiffULPsForNormFormat: 1,\n          maxDiffULPsForFloatFormat: 1,\n        }\n      );\n    });\n    t.eventualExpectOK(Promise.all(promises));\n  });\n\ng.test('color,component_count')\n  .desc(\n    `Test that extra components of the output (e.g. f32, vec2<f32>, vec3<f32>, vec4<f32>) are discarded.`\n  )\n  .params(u =>\n    u\n      .combine('format', kRenderableColorTextureFormats)\n      .beginSubcases()\n      .combine('componentCount', [1, 2, 3, 4])\n      .filter(x => x.componentCount >= kTexelRepresentationInfo[x.format].componentOrder.length)\n  )\n  .beforeAllSubcases(t => {\n    const info = kTextureFormatInfo[t.params.format];\n    t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const { format, componentCount } = t.params;\n    const info = kTextureFormatInfo[format];\n\n    // expected RGBA values\n    // extra channels are discarded\n    const values = [0, 1, 0, 1];\n\n    const renderTarget = t.device.createTexture({\n      format,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: getFragmentShaderCodeWithOutput([\n            {\n              values,\n              plainType: getPlainTypeInfo(info.sampleType),\n              componentCount,\n            },\n          ]),\n        }),\n        entryPoint: 'main',\n        targets: [{ format }],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          storeOp: 'store',\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n        },\n      ],\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    t.expectSingleColor(renderTarget, format, {\n      size: [1, 1, 1],\n      exp: { R: values[0], G: values[1], B: values[2], A: values[3] },\n    });\n  });\n\ng.test('color,component_count,blend')\n  .desc(\n    `Test that blending behaves correctly when:\n- fragment output has no alpha, but the src alpha is not used for the blend operation indicated by blend factors\n- attachment format has no alpha, and the dst alpha should be assumed as 1\n\nThe attachment has a load value of [1, 0, 0, 1]\n`\n  )\n  .params(u =>\n    u\n      .combine('format', ['r8unorm', 'rg8unorm', 'rgba8unorm', 'bgra8unorm'] as const)\n      .beginSubcases()\n      // _result is expected values in the color attachment (extra channels are discarded)\n      // output is the fragment shader output vector\n      // 0.498 -> 0x7f, 0.502 -> 0x80\n      .combineWithParams([\n        // fragment output has no alpha\n        {\n          _result: [0, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0.498, 0, 0, 0],\n          output: [0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        // fragment output has alpha\n        {\n          _result: [0.502, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'one-minus-src-alpha',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0.502, 0.498, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'src-alpha',\n          colorDstFactor: 'one-minus-src-alpha',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'src',\n        },\n        {\n          _result: [1, 0, 0, 1],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'dst-alpha',\n        },\n      ] as const)\n      .filter(x => x.output.length >= kTexelRepresentationInfo[x.format].componentOrder.length)\n  )\n  .beforeAllSubcases(t => {\n    const info = kTextureFormatInfo[t.params.format];\n    t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const {\n      format,\n      _result,\n      output,\n      colorSrcFactor,\n      colorDstFactor,\n      alphaSrcFactor,\n      alphaDstFactor,\n    } = t.params;\n    const componentCount = output.length;\n    const info = kTextureFormatInfo[format];\n\n    const renderTarget = t.device.createTexture({\n      format,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const pipeline = t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: getFragmentShaderCodeWithOutput([\n            {\n              values: output,\n              plainType: getPlainTypeInfo(info.sampleType),\n              componentCount,\n            },\n          ]),\n        }),\n        entryPoint: 'main',\n        targets: [\n          {\n            format,\n            blend: {\n              color: {\n                srcFactor: colorSrcFactor,\n                dstFactor: colorDstFactor,\n                operation: 'add',\n              },\n              alpha: {\n                srcFactor: alphaSrcFactor,\n                dstFactor: alphaDstFactor,\n                operation: 'add',\n              },\n            },\n          },\n        ],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          storeOp: 'store',\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n        },\n      ],\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    t.expectSingleColor(renderTarget, format, {\n      size: [1, 1, 1],\n      exp: { R: _result[0], G: _result[1], B: _result[2], A: _result[3] },\n    });\n  });\n"],"mappings":";AAAA;AAAA,GAAA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA,CAAC,CAED,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,KAAK,QAAQ,iCAAiC;AACvD,SAASC,8BAA8B,EAAEC,kBAAkB,QAAQ,6BAA6B;AAChG,SAASC,OAAO,QAAQ,sBAAsB;AAC9C,SAASC,+BAA+B,EAAEC,gBAAgB,QAAQ,yBAAyB;AAC3F,SAASC,wBAAwB,QAAQ,qCAAqC;AAC9E,SAASC,SAAS,QAAQ,qCAAqC;AAC/D,SAASC,uBAAuB,QAAQ,qCAAqC;;AAE7E,MAAMC,aAAa,GAAI;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,OAAO,MAAMC,CAAC,GAAGX,aAAa,CAACI,OAAO,CAAC;;AAEvC;AACA;AACA;AACA,MAAMQ,yBAAyB,GAAG;AAChC,EAAEC,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1B,EAAEH,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1B,EAAEH,CAAC,EAAE,CAAC,EAAEC,CAAC,EAAE,EAAE,EAAEC,CAAC,EAAE,EAAE,EAAEC,CAAC,EAAE,EAAE,CAAC,CAAC;AAC7B,EAAEH,CAAC,EAAE,EAAE,EAAEC,CAAC,EAAE,EAAE,EAAEC,CAAC,EAAE,EAAE,EAAEC,CAAC,EAAE,EAAE,CAAC,CAAC,CAC/B;;AACD,MAAMC,2BAA2B,GAAG;AAClC,EAAEJ,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,CAAC,CAAC,CAAC;AACnC,EAAEH,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,CAAC,CAAC,CAAC;AAClC,EAAEH,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,GAAG,CAAC,CAAC;AACrC,EAAEH,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,IAAI,EAAEC,CAAC,EAAE,CAAC,CAAC,CAAC,CACpC;;;AAEDL,CAAC,CAACO,IAAI,CAAC,mBAAmB,CAAC;AACxBC,IAAI,CAAE,0EAAyE,CAAC;AAChFC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC;AACEC,OAAO,CAAC,QAAQ,EAAEpB,8BAA8B,CAAC;AACjDqB,aAAa,EAAE;AACfD,OAAO,CAAC,iBAAiB,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACrCE,MAAM,CAAC,mBAAmB,EAAE,CAAAC,CAAC,KAAIxB,KAAK,CAACwB,CAAC,CAACC,eAAe,EAAE,CAAAC,CAAC,KAAIA,CAAC,CAAC,CAAC,CACtE;;AACAC,iBAAiB,CAAC,CAAAC,CAAC,KAAI;EACtB,MAAMC,IAAI,GAAG3B,kBAAkB,CAAC0B,CAAC,CAACT,MAAM,CAACW,MAAM,CAAC;EAChDF,CAAC,CAACG,0BAA0B,CAACF,IAAI,CAACG,OAAO,CAAC;AAC5C,CAAC,CAAC;AACDC,EAAE,CAAC,OAAML,CAAC,KAAI;EACb,MAAM,EAAEE,MAAM,EAAEL,eAAe,EAAES,iBAAiB,CAAC,CAAC,GAAGN,CAAC,CAACT,MAAM;EAC/D,MAAMgB,cAAc,GAAG7B,wBAAwB,CAACwB,MAAM,CAAC,CAACM,cAAc,CAACC,MAAM;EAC7E,MAAMR,IAAI,GAAG3B,kBAAkB,CAAC4B,MAAM,CAAC;;EAEvC,MAAMQ,WAAW;EACfT,IAAI,CAACU,UAAU,KAAK,MAAM,IAAIV,IAAI,CAACU,UAAU,KAAK,MAAM;EACpD5B,yBAAyB;EACzBK,2BAA2B;;EAEjC,MAAMwB,aAAa,GAAGxC,KAAK,CAACyB,eAAe,EAAE;EAC3CG,CAAC,CAACa,MAAM,CAACC,aAAa,CAAC;IACrBZ,MAAM;IACNa,IAAI,EAAE,EAAEC,KAAK,EAAE,CAAC,EAAEC,MAAM,EAAE,CAAC,EAAEC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACpDC,KAAK,EAAEC,eAAe,CAACC,QAAQ,GAAGD,eAAe,CAACE;EACpD,CAAC,CAAC,CACH;;EACD,MAAMC,QAAQ,GAAGvB,CAAC,CAACa,MAAM,CAACW,oBAAoB,CAAC;IAC7CC,MAAM,EAAE,MAAM;IACdC,MAAM,EAAE;MACNC,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAEhD;MACR,CAAC,CAAC;MACFiD,UAAU,EAAE;IACd,CAAC;IACDC,QAAQ,EAAE;MACRJ,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAErD,+BAA+B;QACnCJ,KAAK,CAACyB,eAAe,EAAE,CAAAC,CAAC;QACtBA,CAAC,KAAKQ,iBAAiB;QACnB,IAAI;QACJ;UACE0B,MAAM,EAAE;UACNtB,WAAW,CAACZ,CAAC,CAAC,CAACd,CAAC;UAChB0B,WAAW,CAACZ,CAAC,CAAC,CAACb,CAAC;UAChByB,WAAW,CAACZ,CAAC,CAAC,CAACZ,CAAC;UAChBwB,WAAW,CAACZ,CAAC,CAAC,CAACX,CAAC,CACjB;;UACD8C,SAAS,EAAExD,gBAAgB,CAACwB,IAAI,CAACU,UAAU,CAAC;UAC5CJ;QACF,CAAC,CACN;;;MAEL,CAAC,CAAC;MACFuB,UAAU,EAAE,MAAM;MAClBI,OAAO,EAAE9D,KAAK,CAACyB,eAAe,EAAE,CAAAC,CAAC,KAAKA,CAAC,KAAKQ,iBAAiB,GAAG,IAAI,GAAG,EAAEJ,MAAM,CAAC,CAAE;IACpF,CAAC;IACDiC,SAAS,EAAE,EAAEC,QAAQ,EAAE,eAAe,CAAC;EACzC,CAAC,CAAC;;EAEF,MAAMC,OAAO,GAAGrC,CAAC,CAACa,MAAM,CAACyB,oBAAoB,EAAE;EAC/C,MAAMC,IAAI,GAAGF,OAAO,CAACG,eAAe,CAAC;IACnCC,gBAAgB,EAAErE,KAAK,CAACyB,eAAe,EAAE,CAAAC,CAAC;IACxCA,CAAC,KAAKQ,iBAAiB;IACnB,IAAI;IACJ;MACEoC,IAAI,EAAE9B,aAAa,CAACd,CAAC,CAAC,CAAC6C,UAAU,EAAE;MACnCC,OAAO,EAAE,OAAO;MAChBC,UAAU,EAAE,EAAEC,CAAC,EAAE,GAAG,EAAEhE,CAAC,EAAE,GAAG,EAAEiE,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,CAAC,CAAC;MAC9CC,MAAM,EAAE;IACV,CAAC;;EAET,CAAC,CAAC;EACFV,IAAI,CAACW,WAAW,CAAC3B,QAAQ,CAAC;EAC1BgB,IAAI,CAACY,IAAI,CAAC,CAAC,CAAC;EACZZ,IAAI,CAACa,GAAG,EAAE;EACVpD,CAAC,CAACa,MAAM,CAACwC,KAAK,CAACC,MAAM,CAAC,CAACjB,OAAO,CAACkB,MAAM,EAAE,CAAC,CAAC;;EAEzC,MAAMC,QAAQ,GAAGpF,KAAK,CAACyB,eAAe,EAAE,CAAAC,CAAC,KAAI;IAC3C,IAAIA,CAAC,KAAKQ,iBAAiB,EAAE;MAC3B,OAAOmD,SAAS;IAClB;IACA,OAAO7E,uBAAuB;IAC5BoB,CAAC;IACD,EAAE0D,OAAO,EAAE9C,aAAa,CAACd,CAAC,CAAC,CAAC,CAAC;IAC7B,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACT;MACE6D,YAAY,EAAEhF,SAAS,CAACiF,kBAAkB,CAAC1D,MAAM,EAAE,CAAA2D,MAAM,KAAInD,WAAW,CAACZ,CAAC,CAAC;IAC7E,CAAC;IACD;MACEgE,UAAU,EAAE,CAAC;MACbC,wBAAwB,EAAE,CAAC;MAC3BC,yBAAyB,EAAE;IAC7B,CAAC,CACF;;EACH,CAAC,CAAC;EACFhE,CAAC,CAACiE,gBAAgB,CAACC,OAAO,CAACC,GAAG,CAACX,QAAQ,CAAC,CAAC;AAC3C,CAAC,CAAC;;AAEJ1E,CAAC,CAACO,IAAI,CAAC,uBAAuB,CAAC;AAC5BC,IAAI;AACF,qGAAoG,CACtG;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC;AACEC,OAAO,CAAC,QAAQ,EAAEpB,8BAA8B,CAAC;AACjDqB,aAAa,EAAE;AACfD,OAAO,CAAC,gBAAgB,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACvC2E,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAAC9D,cAAc,IAAI7B,wBAAwB,CAAC2F,CAAC,CAACnE,MAAM,CAAC,CAACM,cAAc,CAACC,MAAM,CAAC,CAC7F;;AACAV,iBAAiB,CAAC,CAAAC,CAAC,KAAI;EACtB,MAAMC,IAAI,GAAG3B,kBAAkB,CAAC0B,CAAC,CAACT,MAAM,CAACW,MAAM,CAAC;EAChDF,CAAC,CAACG,0BAA0B,CAACF,IAAI,CAACG,OAAO,CAAC;AAC5C,CAAC,CAAC;AACDC,EAAE,CAAC,OAAML,CAAC,KAAI;EACb,MAAM,EAAEE,MAAM,EAAEK,cAAc,CAAC,CAAC,GAAGP,CAAC,CAACT,MAAM;EAC3C,MAAMU,IAAI,GAAG3B,kBAAkB,CAAC4B,MAAM,CAAC;;EAEvC;EACA;EACA,MAAM8B,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;;EAE3B,MAAMsC,YAAY,GAAGtE,CAAC,CAACa,MAAM,CAACC,aAAa,CAAC;IAC1CZ,MAAM;IACNa,IAAI,EAAE,EAAEC,KAAK,EAAE,CAAC,EAAEC,MAAM,EAAE,CAAC,EAAEC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACpDC,KAAK,EAAEC,eAAe,CAACC,QAAQ,GAAGD,eAAe,CAACE;EACpD,CAAC,CAAC;;EAEF,MAAMC,QAAQ,GAAGvB,CAAC,CAACa,MAAM,CAACW,oBAAoB,CAAC;IAC7CC,MAAM,EAAE,MAAM;IACdC,MAAM,EAAE;MACNC,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAEhD;MACR,CAAC,CAAC;MACFiD,UAAU,EAAE;IACd,CAAC;IACDC,QAAQ,EAAE;MACRJ,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAErD,+BAA+B,CAAC;QACpC;UACEwD,MAAM;UACNC,SAAS,EAAExD,gBAAgB,CAACwB,IAAI,CAACU,UAAU,CAAC;UAC5CJ;QACF,CAAC,CACF;;MACH,CAAC,CAAC;MACFuB,UAAU,EAAE,MAAM;MAClBI,OAAO,EAAE,CAAC,EAAEhC,MAAM,CAAC,CAAC;IACtB,CAAC;IACDiC,SAAS,EAAE,EAAEC,QAAQ,EAAE,eAAe,CAAC;EACzC,CAAC,CAAC;;EAEF,MAAMC,OAAO,GAAGrC,CAAC,CAACa,MAAM,CAACyB,oBAAoB,EAAE;EAC/C,MAAMC,IAAI,GAAGF,OAAO,CAACG,eAAe,CAAC;IACnCC,gBAAgB,EAAE;IAChB;MACEC,IAAI,EAAE4B,YAAY,CAAC3B,UAAU,EAAE;MAC/BC,OAAO,EAAE,OAAO;MAChBC,UAAU,EAAE,EAAEC,CAAC,EAAE,GAAG,EAAEhE,CAAC,EAAE,GAAG,EAAEiE,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,CAAC,CAAC;MAC9CC,MAAM,EAAE;IACV,CAAC;;EAEL,CAAC,CAAC;EACFV,IAAI,CAACW,WAAW,CAAC3B,QAAQ,CAAC;EAC1BgB,IAAI,CAACY,IAAI,CAAC,CAAC,CAAC;EACZZ,IAAI,CAACa,GAAG,EAAE;EACVpD,CAAC,CAACa,MAAM,CAACwC,KAAK,CAACC,MAAM,CAAC,CAACjB,OAAO,CAACkB,MAAM,EAAE,CAAC,CAAC;;EAEzCvD,CAAC,CAACuE,iBAAiB,CAACD,YAAY,EAAEpE,MAAM,EAAE;IACxCa,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACfyD,GAAG,EAAE,EAAExF,CAAC,EAAEgD,MAAM,CAAC,CAAC,CAAC,EAAE/C,CAAC,EAAE+C,MAAM,CAAC,CAAC,CAAC,EAAE9C,CAAC,EAAE8C,MAAM,CAAC,CAAC,CAAC,EAAE7C,CAAC,EAAE6C,MAAM,CAAC,CAAC,CAAC,CAAC;EAChE,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEJlD,CAAC,CAACO,IAAI,CAAC,6BAA6B,CAAC;AAClCC,IAAI;AACF;AACL;AACA;AACA;AACA;AACA,CAAC,CACE;;AACAC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC;AACEC,OAAO,CAAC,QAAQ,EAAE,CAAC,SAAS,EAAE,UAAU,EAAE,YAAY,EAAE,YAAY,CAAC,CAAU;AAC/EC,aAAa;AACd;AACA;AACA;AAAA,CACC+E,iBAAiB,CAAC;AACjB;AACA;EACEC,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,CAAC;EACXC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,CAAC;EACXC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,CAAC;EACXC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACzBC,MAAM,EAAE,CAAC,KAAK,CAAC;EACfC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;EACdC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;EACdC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;EACdC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACjBC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACjBC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACjBC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;AACA;EACEL,OAAO,EAAE,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EAC7BC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACxBC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,CAAC;EACjCC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACxBC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACzBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACxBC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,KAAK;EACrBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACzBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACxBC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC;AACD;EACEL,OAAO,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EACrBC,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC;EACxBC,cAAc,EAAE,qBAAqB;EACrCC,cAAc,EAAE,WAAW;EAC3BC,cAAc,EAAE,MAAM;EACtBC,cAAc,EAAE;AAClB,CAAC,CACF,CAAU;;AACVX,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACM,MAAM,CAAClE,MAAM,IAAI/B,wBAAwB,CAAC2F,CAAC,CAACnE,MAAM,CAAC,CAACM,cAAc,CAACC,MAAM,CAAC,CAC5F;;AACAV,iBAAiB,CAAC,CAAAC,CAAC,KAAI;EACtB,MAAMC,IAAI,GAAG3B,kBAAkB,CAAC0B,CAAC,CAACT,MAAM,CAACW,MAAM,CAAC;EAChDF,CAAC,CAACG,0BAA0B,CAACF,IAAI,CAACG,OAAO,CAAC;AAC5C,CAAC,CAAC;AACDC,EAAE,CAAC,OAAML,CAAC,KAAI;EACb,MAAM;IACJE,MAAM;IACNwE,OAAO;IACPC,MAAM;IACNC,cAAc;IACdC,cAAc;IACdC,cAAc;IACdC;EACF,CAAC,GAAG/E,CAAC,CAACT,MAAM;EACZ,MAAMgB,cAAc,GAAGoE,MAAM,CAAClE,MAAM;EACpC,MAAMR,IAAI,GAAG3B,kBAAkB,CAAC4B,MAAM,CAAC;;EAEvC,MAAMoE,YAAY,GAAGtE,CAAC,CAACa,MAAM,CAACC,aAAa,CAAC;IAC1CZ,MAAM;IACNa,IAAI,EAAE,EAAEC,KAAK,EAAE,CAAC,EAAEC,MAAM,EAAE,CAAC,EAAEC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IACpDC,KAAK,EAAEC,eAAe,CAACC,QAAQ,GAAGD,eAAe,CAACE;EACpD,CAAC,CAAC;;EAEF,MAAMC,QAAQ,GAAGvB,CAAC,CAACa,MAAM,CAACW,oBAAoB,CAAC;IAC7CC,MAAM,EAAE,MAAM;IACdC,MAAM,EAAE;MACNC,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAEhD;MACR,CAAC,CAAC;MACFiD,UAAU,EAAE;IACd,CAAC;IACDC,QAAQ,EAAE;MACRJ,MAAM,EAAE3B,CAAC,CAACa,MAAM,CAACe,kBAAkB,CAAC;QAClCC,IAAI,EAAErD,+BAA+B,CAAC;QACpC;UACEwD,MAAM,EAAE2C,MAAM;UACd1C,SAAS,EAAExD,gBAAgB,CAACwB,IAAI,CAACU,UAAU,CAAC;UAC5CJ;QACF,CAAC,CACF;;MACH,CAAC,CAAC;MACFuB,UAAU,EAAE,MAAM;MAClBI,OAAO,EAAE;MACP;QACEhC,MAAM;QACN8E,KAAK,EAAE;UACLC,KAAK,EAAE;YACLC,SAAS,EAAEN,cAAc;YACzBO,SAAS,EAAEN,cAAc;YACzBO,SAAS,EAAE;UACb,CAAC;UACDC,KAAK,EAAE;YACLH,SAAS,EAAEJ,cAAc;YACzBK,SAAS,EAAEJ,cAAc;YACzBK,SAAS,EAAE;UACb;QACF;MACF,CAAC;;IAEL,CAAC;IACDjD,SAAS,EAAE,EAAEC,QAAQ,EAAE,eAAe,CAAC;EACzC,CAAC,CAAC;;EAEF,MAAMC,OAAO,GAAGrC,CAAC,CAACa,MAAM,CAACyB,oBAAoB,EAAE;EAC/C,MAAMC,IAAI,GAAGF,OAAO,CAACG,eAAe,CAAC;IACnCC,gBAAgB,EAAE;IAChB;MACEC,IAAI,EAAE4B,YAAY,CAAC3B,UAAU,EAAE;MAC/BC,OAAO,EAAE,OAAO;MAChBC,UAAU,EAAE,EAAEC,CAAC,EAAE,GAAG,EAAEhE,CAAC,EAAE,GAAG,EAAEiE,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,CAAC,CAAC;MAC9CC,MAAM,EAAE;IACV,CAAC;;EAEL,CAAC,CAAC;EACFV,IAAI,CAACW,WAAW,CAAC3B,QAAQ,CAAC;EAC1BgB,IAAI,CAACY,IAAI,CAAC,CAAC,CAAC;EACZZ,IAAI,CAACa,GAAG,EAAE;EACVpD,CAAC,CAACa,MAAM,CAACwC,KAAK,CAACC,MAAM,CAAC,CAACjB,OAAO,CAACkB,MAAM,EAAE,CAAC,CAAC;;EAEzCvD,CAAC,CAACuE,iBAAiB,CAACD,YAAY,EAAEpE,MAAM,EAAE;IACxCa,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;IACfyD,GAAG,EAAE,EAAExF,CAAC,EAAE0F,OAAO,CAAC,CAAC,CAAC,EAAEzF,CAAC,EAAEyF,OAAO,CAAC,CAAC,CAAC,EAAExF,CAAC,EAAEwF,OAAO,CAAC,CAAC,CAAC,EAAEvF,CAAC,EAAEuF,OAAO,CAAC,CAAC,CAAC,CAAC;EACpE,CAAC,CAAC;AACJ,CAAC,CAAC"}