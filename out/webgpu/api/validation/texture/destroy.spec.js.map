{"version":3,"sources":["../../../../../src/webgpu/api/validation/texture/destroy.spec.ts"],"names":["description","makeTestGroup","ValidationTest","g","test","desc","fn","t","texture","getSampledTexture","destroy","paramsSimple","destroyBeforeEncode","destroyAfterEncode","_success","params","getRenderTexture","textureView","createView","commandEncoder","device","createCommandEncoder","renderPass","beginRenderPass","colorAttachments","view","loadValue","r","b","a","storeOp","endPass","commandBuffer","finish","expectValidationError","queue","submit"],"mappings":";AAAA;AACA,GADA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA,CAFO,CAIP,SAASC,aAAT,QAA8B,4CAA9B;AACA,SAASC,cAAT,QAA+B,uBAA/B;;AAEA,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,cAAD,CAAvB;;AAEPC,CAAC,CAACC,IAAF,CAAO,MAAP;AACGC,IADH,CACS,6CADT;AAEGC,EAFH,CAEMC,CAAC,IAAI;AACP,QAAMC,OAAO,GAAGD,CAAC,CAACE,iBAAF,EAAhB;AACAD,EAAAA,OAAO,CAACE,OAAR;AACD,CALH;;AAOAP,CAAC,CAACC,IAAF,CAAO,OAAP;AACGC,IADH,CACS,uDADT;AAEGC,EAFH,CAEMC,CAAC,IAAI;AACP,QAAMC,OAAO,GAAGD,CAAC,CAACE,iBAAF,EAAhB;AACAD,EAAAA,OAAO,CAACE,OAAR;AACAF,EAAAA,OAAO,CAACE,OAAR;AACD,CANH;;AAQAP,CAAC,CAACC,IAAF,CAAO,4BAAP;AACGC,IADH;AAEK,wGAFL;;AAIGM,YAJH,CAIgB;AACZ,EAAEC,mBAAmB,EAAE,KAAvB,EAA8BC,kBAAkB,EAAE,KAAlD,EAAyDC,QAAQ,EAAE,IAAnE,EADY;AAEZ,EAAEF,mBAAmB,EAAE,IAAvB,EAA6BC,kBAAkB,EAAE,KAAjD,EAAwDC,QAAQ,EAAE,KAAlE,EAFY;AAGZ,EAAEF,mBAAmB,EAAE,KAAvB,EAA8BC,kBAAkB,EAAE,IAAlD,EAAwDC,QAAQ,EAAE,KAAlE,EAHY,CAJhB;;AASGR,EATH,CASM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEK,mBAAF,EAAuBC,kBAAvB,EAA2CC,QAA3C,KAAwDP,CAAC,CAACQ,MAAhE;;AAEA,QAAMP,OAAO,GAAGD,CAAC,CAACS,gBAAF,EAAhB;AACA,QAAMC,WAAW,GAAGT,OAAO,CAACU,UAAR,EAApB;;AAEA,MAAIN,mBAAJ,EAAyB;AACvBJ,IAAAA,OAAO,CAACE,OAAR;AACD;;AAED,QAAMS,cAAc,GAAGZ,CAAC,CAACa,MAAF,CAASC,oBAAT,EAAvB;AACA,QAAMC,UAAU,GAAGH,cAAc,CAACI,eAAf,CAA+B;AAChDC,IAAAA,gBAAgB,EAAE;AAChB;AACEC,MAAAA,IAAI,EAAER,WADR;AAEES,MAAAA,SAAS,EAAE,EAAEC,CAAC,EAAE,GAAL,EAAUxB,CAAC,EAAE,GAAb,EAAkByB,CAAC,EAAE,GAArB,EAA0BC,CAAC,EAAE,GAA7B,EAFb;AAGEC,MAAAA,OAAO,EAAE,OAHX,EADgB,CAD8B,EAA/B,CAAnB;;;;AASAR,EAAAA,UAAU,CAACS,OAAX;AACA,QAAMC,aAAa,GAAGb,cAAc,CAACc,MAAf,EAAtB;;AAEA,MAAIpB,kBAAJ,EAAwB;AACtBL,IAAAA,OAAO,CAACE,OAAR;AACD;;AAEDH,EAAAA,CAAC,CAAC2B,qBAAF,CAAwB,MAAM;AAC5B3B,IAAAA,CAAC,CAAC4B,KAAF,CAAQC,MAAR,CAAe,CAACJ,aAAD,CAAf;AACD,GAFD,EAEG,CAAClB,QAFJ;AAGD,CAvCH","sourcesContent":["export const description = `\nDestroying a texture more than once is allowed.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ValidationTest } from '../validation_test.js';\n\nexport const g = makeTestGroup(ValidationTest);\n\ng.test('base')\n  .desc(`Test that it is valid to destroy a texture.`)\n  .fn(t => {\n    const texture = t.getSampledTexture();\n    texture.destroy();\n  });\n\ng.test('twice')\n  .desc(`Test that it is valid to destroy a destroyed texture.`)\n  .fn(t => {\n    const texture = t.getSampledTexture();\n    texture.destroy();\n    texture.destroy();\n  });\n\ng.test('submit_a_destroyed_texture')\n  .desc(\n    `Test that it is invalid to submit with a texture that was destroyed {before, after} encoding finishes.`\n  )\n  .paramsSimple([\n    { destroyBeforeEncode: false, destroyAfterEncode: false, _success: true },\n    { destroyBeforeEncode: true, destroyAfterEncode: false, _success: false },\n    { destroyBeforeEncode: false, destroyAfterEncode: true, _success: false },\n  ])\n  .fn(async t => {\n    const { destroyBeforeEncode, destroyAfterEncode, _success } = t.params;\n\n    const texture = t.getRenderTexture();\n    const textureView = texture.createView();\n\n    if (destroyBeforeEncode) {\n      texture.destroy();\n    }\n\n    const commandEncoder = t.device.createCommandEncoder();\n    const renderPass = commandEncoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: textureView,\n          loadValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          storeOp: 'store',\n        },\n      ],\n    });\n    renderPass.endPass();\n    const commandBuffer = commandEncoder.finish();\n\n    if (destroyAfterEncode) {\n      texture.destroy();\n    }\n\n    t.expectValidationError(() => {\n      t.queue.submit([commandBuffer]);\n    }, !_success);\n  });\n"],"file":"destroy.spec.js"}