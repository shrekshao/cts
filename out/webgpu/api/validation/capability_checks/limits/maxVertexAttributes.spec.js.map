{"version":3,"file":"maxVertexAttributes.spec.js","names":["kLimitBaseParams","makeLimitTestGroup","getPipelineDescriptor","device","lastIndex","code","module","createShaderModule","layout","vertex","entryPoint","buffers","arrayStride","attributes","shaderLocation","offset","format","limit","g","description","test","desc","params","fn","t","limitTest","testValueName","testDeviceWithRequestedLimits","testValue","shouldError","pipelineDescriptor","expectValidationError","createRenderPipeline","shouldRejectConditionally","createRenderPipelineAsync"],"sources":["../../../../../../src/webgpu/api/validation/capability_checks/limits/maxVertexAttributes.spec.ts"],"sourcesContent":["import { kLimitBaseParams, makeLimitTestGroup } from './limit_utils.js';\n\nfunction getPipelineDescriptor(device: GPUDevice, lastIndex: number): GPURenderPipelineDescriptor {\n  const code = `\n  @vertex fn vs(@location(${lastIndex}) v: vec4f) -> @builtin(position) vec4f {\n    return v;\n  }\n  `;\n  const module = device.createShaderModule({ code });\n  return {\n    layout: 'auto',\n    vertex: {\n      module,\n      entryPoint: 'vs',\n      buffers: [\n        {\n          arrayStride: 32,\n          attributes: [{ shaderLocation: lastIndex, offset: 0, format: 'float32x4' }],\n        },\n      ],\n    },\n  };\n}\n\nconst limit = 'maxVertexAttributes';\nexport const { g, description } = makeLimitTestGroup(limit);\n\ng.test('createRenderPipeline,at_over')\n  .desc(`Test using createRenderPipeline at and over ${limit} limit`)\n  .params(kLimitBaseParams)\n  .fn(async t => {\n    const { limitTest, testValueName } = t.params;\n    await t.testDeviceWithRequestedLimits(\n      limitTest,\n      testValueName,\n      async ({ device, testValue, shouldError }) => {\n        const lastIndex = testValue - 1;\n        const pipelineDescriptor = getPipelineDescriptor(device, lastIndex);\n\n        await t.expectValidationError(() => {\n          device.createRenderPipeline(pipelineDescriptor);\n        }, shouldError);\n      }\n    );\n  });\n\ng.test('createRenderPipelineAsync,at_over')\n  .desc(`Test using createRenderPipelineAsync at and over ${limit} limit`)\n  .params(kLimitBaseParams)\n  .fn(async t => {\n    const { limitTest, testValueName } = t.params;\n    await t.testDeviceWithRequestedLimits(\n      limitTest,\n      testValueName,\n      async ({ device, testValue, shouldError }) => {\n        const lastIndex = testValue - 1;\n        const pipelineDescriptor = getPipelineDescriptor(device, lastIndex);\n\n        await t.shouldRejectConditionally(\n          'GPUPipelineError',\n          device.createRenderPipelineAsync(pipelineDescriptor),\n          shouldError\n        );\n      }\n    );\n  });\n"],"mappings":";AAAA;AAAA,GAAA,SAASA,gBAAgB,EAAEC,kBAAkB,QAAQ,kBAAkB,CAEvE,SAASC,qBAAqB,CAACC,MAAiB,EAAEC,SAAiB,EAA+B;EAChG,MAAMC,IAAI,GAAI;AAChB,4BAA4BD,SAAU;AACtC;AACA;AACA,GAAG;EACD,MAAME,MAAM,GAAGH,MAAM,CAACI,kBAAkB,CAAC,EAAEF,IAAI,CAAC,CAAC,CAAC;EAClD,OAAO;IACLG,MAAM,EAAE,MAAM;IACdC,MAAM,EAAE;MACNH,MAAM;MACNI,UAAU,EAAE,IAAI;MAChBC,OAAO,EAAE;MACP;QACEC,WAAW,EAAE,EAAE;QACfC,UAAU,EAAE,CAAC,EAAEC,cAAc,EAAEV,SAAS,EAAEW,MAAM,EAAE,CAAC,EAAEC,MAAM,EAAE,WAAW,CAAC,CAAC;MAC5E,CAAC;;IAEL;EACF,CAAC;AACH;;AAEA,MAAMC,KAAK,GAAG,qBAAqB;AACnC,OAAO,MAAM,EAAEC,CAAC,EAAEC,WAAW,CAAC,CAAC,GAAGlB,kBAAkB,CAACgB,KAAK,CAAC;;AAE3DC,CAAC,CAACE,IAAI,CAAC,8BAA8B,CAAC;AACnCC,IAAI,CAAE,+CAA8CJ,KAAM,QAAO,CAAC;AAClEK,MAAM,CAACtB,gBAAgB,CAAC;AACxBuB,EAAE,CAAC,OAAMC,CAAC,KAAI;EACb,MAAM,EAAEC,SAAS,EAAEC,aAAa,CAAC,CAAC,GAAGF,CAAC,CAACF,MAAM;EAC7C,MAAME,CAAC,CAACG,6BAA6B;EACnCF,SAAS;EACTC,aAAa;EACb,OAAO,EAAEvB,MAAM,EAAEyB,SAAS,EAAEC,WAAW,CAAC,CAAC,KAAK;IAC5C,MAAMzB,SAAS,GAAGwB,SAAS,GAAG,CAAC;IAC/B,MAAME,kBAAkB,GAAG5B,qBAAqB,CAACC,MAAM,EAAEC,SAAS,CAAC;;IAEnE,MAAMoB,CAAC,CAACO,qBAAqB,CAAC,MAAM;MAClC5B,MAAM,CAAC6B,oBAAoB,CAACF,kBAAkB,CAAC;IACjD,CAAC,EAAED,WAAW,CAAC;EACjB,CAAC,CACF;;AACH,CAAC,CAAC;;AAEJX,CAAC,CAACE,IAAI,CAAC,mCAAmC,CAAC;AACxCC,IAAI,CAAE,oDAAmDJ,KAAM,QAAO,CAAC;AACvEK,MAAM,CAACtB,gBAAgB,CAAC;AACxBuB,EAAE,CAAC,OAAMC,CAAC,KAAI;EACb,MAAM,EAAEC,SAAS,EAAEC,aAAa,CAAC,CAAC,GAAGF,CAAC,CAACF,MAAM;EAC7C,MAAME,CAAC,CAACG,6BAA6B;EACnCF,SAAS;EACTC,aAAa;EACb,OAAO,EAAEvB,MAAM,EAAEyB,SAAS,EAAEC,WAAW,CAAC,CAAC,KAAK;IAC5C,MAAMzB,SAAS,GAAGwB,SAAS,GAAG,CAAC;IAC/B,MAAME,kBAAkB,GAAG5B,qBAAqB,CAACC,MAAM,EAAEC,SAAS,CAAC;;IAEnE,MAAMoB,CAAC,CAACS,yBAAyB;IAC/B,kBAAkB;IAClB9B,MAAM,CAAC+B,yBAAyB,CAACJ,kBAAkB,CAAC;IACpDD,WAAW,CACZ;;EACH,CAAC,CACF;;AACH,CAAC,CAAC"}