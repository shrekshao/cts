{"version":3,"sources":["../../../../../../src/webgpu/api/validation/encoding/cmds/dynamic_render_state.spec.ts"],"names":["description","params","makeTestGroup","ValidationTest","F","testViewportCall","success","v","attachmentSize","width","height","depth","attachment","device","createTexture","format","size","usage","GPUTextureUsage","OUTPUT_ATTACHMENT","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","createView","loadValue","setViewport","x","y","w","h","minDepth","maxDepth","endPass","expectValidationError","finish","testScissorCall","s","shouldThrow","setScissorRect","createDummyRenderPassEncoder","g","test","desc","fn","t","combine","attachmentWidth","attachmentHeight","dx","dy","dw","dh","r","b","a","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","encoders","setBlendColor","value","setStencilReference"],"mappings":"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","sourcesContent":["export const description = `\nAPI validation tests for dynamic state commands (setViewport/ScissorRect/BlendColor...).\n\nTODO: ensure existing tests cover these notes. Note many of these may be operation tests instead.\n> - setViewport\n>     - {x, y} = {0, invalid values if any}\n>     - {width, height, minDepth, maxDepth} = {\n>         - least possible value that's valid\n>         - greatest possible negative value that's invalid\n>         - greatest possible positive value that's valid\n>         - least possible positive value that's invalid if any\n>         - }\n>     - minDepth {<, =, >} maxDepth\n> - setScissorRect\n>     - {width, height} = 0\n>     - {x+width, y+height} = attachment size + 1\n> - setBlendColor\n>     - color {slightly, very} out of range\n>     - used with a simple pipeline that {does, doesn't} use it\n> - setStencilReference\n>     - {0, max}\n>     - used with a simple pipeline that {does, doesn't} use it\n\nTODO: setIndexBuffer, setVertexBuffer state (maybe in another file).\n`;\n\nimport { params } from '../../../../../common/framework/params_builder.js';\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { ValidationTest } from '../../validation_test.js';\n\ninterface ViewportCall {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n  minDepth: number;\n  maxDepth: number;\n}\n\ninterface ScissorCall {\n  x: number;\n  y: number;\n  w: number;\n  h: number;\n}\n\nclass F extends ValidationTest {\n  testViewportCall(\n    success: boolean,\n    v: ViewportCall,\n    attachmentSize: GPUExtent3D = { width: 1, height: 1, depth: 1 }\n  ) {\n    const attachment = this.device.createTexture({\n      format: 'rgba8unorm',\n      size: attachmentSize,\n      usage: GPUTextureUsage.OUTPUT_ATTACHMENT,\n    });\n\n    const encoder = this.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          attachment: attachment.createView(),\n          loadValue: 'load',\n        },\n      ],\n    });\n    pass.setViewport(v.x, v.y, v.w, v.h, v.minDepth, v.maxDepth);\n    pass.endPass();\n\n    this.expectValidationError(() => {\n      encoder.finish();\n    }, !success);\n  }\n\n  testScissorCall(\n    success: boolean | 'type-error',\n    s: ScissorCall,\n    attachmentSize: GPUExtent3D = { width: 1, height: 1, depth: 1 }\n  ) {\n    const attachment = this.device.createTexture({\n      format: 'rgba8unorm',\n      size: attachmentSize,\n      usage: GPUTextureUsage.OUTPUT_ATTACHMENT,\n    });\n\n    const encoder = this.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          attachment: attachment.createView(),\n          loadValue: 'load',\n        },\n      ],\n    });\n    if (success === 'type-error') {\n      this.shouldThrow('TypeError', () => {\n        pass.setScissorRect(s.x, s.y, s.w, s.h);\n      });\n    } else {\n      pass.setScissorRect(s.x, s.y, s.w, s.h);\n      pass.endPass();\n\n      this.expectValidationError(() => {\n        encoder.finish();\n      }, !success);\n    }\n  }\n\n  createDummyRenderPassEncoder(): { encoder: GPUCommandEncoder; pass: GPURenderPassEncoder } {\n    const attachment = this.device.createTexture({\n      format: 'rgba8unorm',\n      size: [1, 1, 1],\n      usage: GPUTextureUsage.OUTPUT_ATTACHMENT,\n    });\n\n    const encoder = this.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          attachment: attachment.createView(),\n          loadValue: 'load',\n        },\n      ],\n    });\n\n    return { encoder, pass };\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('setViewport,x_y_width_height_nonnegative')\n  .desc('Test that the parameters of setViewport to define the box must be non-negative.')\n  .params([\n    // Control case: everything to 0 is ok, covers the empty viewport case.\n    { x: 0, y: 0, w: 0, h: 0 },\n\n    // Test -1\n    { x: -1, y: 0, w: 0, h: 0 },\n    { x: 0, y: -1, w: 0, h: 0 },\n    { x: 0, y: 0, w: -1, h: 0 },\n    { x: 0, y: 0, w: 0, h: -1 },\n\n    // TODO Test -0 (it should be valid) but can't be tested because the harness complains about duplicate parameters.\n    // TODO Test the first value smaller than -0\n  ])\n  .fn(t => {\n    const { x, y, w, h } = t.params;\n    const success = x >= 0 && y >= 0 && w >= 0 && h >= 0;\n    t.testViewportCall(success, { x, y, w, h, minDepth: 0, maxDepth: 1 });\n  });\n\ng.test('setViewport,xy_rect_contained_in_attachment')\n  .desc(\n    'Test that the rectangle defined by x, y, width, height must be contained in the attachments'\n  )\n  .params(\n    params()\n      .combine([\n        { attachmentWidth: 3, attachmentHeight: 5 },\n        { attachmentWidth: 5, attachmentHeight: 3 },\n        { attachmentWidth: 1024, attachmentHeight: 1 },\n        { attachmentWidth: 1, attachmentHeight: 1024 },\n      ])\n      .combine([\n        // Control case: a full viewport is valid.\n        { dx: 0, dy: 0, dw: 0, dh: 0 },\n\n        // Other valid cases with a partial viewport.\n        { dx: 1, dy: 0, dw: -1, dh: 0 },\n        { dx: 0, dy: 1, dw: 0, dh: -1 },\n        { dx: 0, dy: 0, dw: -1, dh: 0 },\n        { dx: 0, dy: 0, dw: 0, dh: -1 },\n\n        // Test with a small value that causes the viewport to go outside the attachment.\n        { dx: 1, dy: 0, dw: 0, dh: 0 },\n        { dx: 0, dy: 1, dw: 0, dh: 0 },\n        { dx: 0, dy: 0, dw: 1, dh: 0 },\n        { dx: 0, dy: 0, dw: 0, dh: 1 },\n      ])\n  )\n  .fn(t => {\n    const { attachmentWidth, attachmentHeight, dx, dy, dw, dh } = t.params;\n    const x = dx;\n    const y = dy;\n    const w = attachmentWidth + dw;\n    const h = attachmentWidth + dh;\n\n    const success = x + w <= attachmentWidth && y + h <= attachmentHeight;\n    t.testViewportCall(\n      success,\n      { x, y, w, h, minDepth: 0, maxDepth: 1 },\n      { width: attachmentWidth, height: attachmentHeight, depth: 1 }\n    );\n  });\n\ng.test('setViewport,depth_rangeAndOrder')\n  .desc('Test that 0 <= minDepth <= maxDepth <= 1')\n  .params([\n    // Success cases\n    { minDepth: 0, maxDepth: 1 },\n    { minDepth: -0, maxDepth: -0 },\n    { minDepth: 1, maxDepth: 1 },\n    { minDepth: 0.3, maxDepth: 0.7 },\n    { minDepth: 0.7, maxDepth: 0.7 },\n    { minDepth: 0.3, maxDepth: 0.3 },\n\n    // Invalid cases\n    { minDepth: -0.1, maxDepth: 1 },\n    { minDepth: 0, maxDepth: 1.1 },\n    { minDepth: 0.5, maxDepth: 0.49999 },\n  ])\n  .fn(t => {\n    const { minDepth, maxDepth } = t.params;\n    const success =\n      0 <= minDepth && minDepth <= 1 && 0 <= maxDepth && maxDepth <= 1 && minDepth <= maxDepth;\n    t.testViewportCall(success, { x: 0, y: 0, w: 1, h: 1, minDepth, maxDepth });\n  });\n\ng.test('setScissorRect,x_y_width_height_nonnegative')\n  .desc(\n    'Test that the parameters of setScissorRect to define the box must be non-negative or a TypeError is thrown.'\n  )\n  .params([\n    // Control case: everything to 0 is ok, covers the empty scissor case.\n    { x: 0, y: 0, w: 0, h: 0 },\n\n    // Test -1\n    { x: -1, y: 0, w: 0, h: 0 },\n    { x: 0, y: -1, w: 0, h: 0 },\n    { x: 0, y: 0, w: -1, h: 0 },\n    { x: 0, y: 0, w: 0, h: -1 },\n\n    // TODO Test -0 (it should be valid) but can't be tested because the harness complains about duplicate parameters.\n    // TODO Test the first value smaller than -0\n  ])\n  .fn(t => {\n    const { x, y, w, h } = t.params;\n    const success = x >= 0 && y >= 0 && w >= 0 && h >= 0;\n    t.testScissorCall(success ? true : 'type-error', { x, y, w, h });\n  });\n\ng.test('setScissorRect,xy_rect_contained_in_attachment')\n  .desc(\n    'Test that the rectangle defined by x, y, width, height must be contained in the attachments'\n  )\n  .params(\n    params()\n      .combine([\n        { attachmentWidth: 3, attachmentHeight: 5 },\n        { attachmentWidth: 5, attachmentHeight: 3 },\n        { attachmentWidth: 1024, attachmentHeight: 1 },\n        { attachmentWidth: 1, attachmentHeight: 1024 },\n      ])\n      .combine([\n        // Control case: a full scissor is valid.\n        { dx: 0, dy: 0, dw: 0, dh: 0 },\n\n        // Other valid cases with a partial scissor.\n        { dx: 1, dy: 0, dw: -1, dh: 0 },\n        { dx: 0, dy: 1, dw: 0, dh: -1 },\n        { dx: 0, dy: 0, dw: -1, dh: 0 },\n        { dx: 0, dy: 0, dw: 0, dh: -1 },\n\n        // Test with a small value that causes the scissor to go outside the attachment.\n        { dx: 1, dy: 0, dw: 0, dh: 0 },\n        { dx: 0, dy: 1, dw: 0, dh: 0 },\n        { dx: 0, dy: 0, dw: 1, dh: 0 },\n        { dx: 0, dy: 0, dw: 0, dh: 1 },\n      ])\n  )\n  .fn(t => {\n    const { attachmentWidth, attachmentHeight, dx, dy, dw, dh } = t.params;\n    const x = dx;\n    const y = dy;\n    const w = attachmentWidth + dw;\n    const h = attachmentWidth + dh;\n\n    const success = x + w <= attachmentWidth && y + h <= attachmentHeight;\n    t.testScissorCall(\n      success,\n      { x, y, w, h },\n      { width: attachmentWidth, height: attachmentHeight, depth: 1 }\n    );\n  });\n\ng.test('setBlendColor')\n  .desc('Test that almost any color value is valid for setBlendColor')\n  .params([\n    { r: 1.0, g: 1.0, b: 1.0, a: 1.0 },\n    { r: -1.0, g: -1.0, b: -1.0, a: -1.0 },\n    { r: Number.MAX_SAFE_INTEGER, g: Number.MIN_SAFE_INTEGER, b: -0, a: 100000 },\n  ])\n  .fn(t => {\n    const { r, g, b, a } = t.params;\n    const encoders = t.createDummyRenderPassEncoder();\n    encoders.pass.setBlendColor({ r, g, b, a });\n    encoders.pass.endPass();\n    encoders.encoder.finish();\n  });\n\ng.test('setStencilReference')\n  .desc('Test that almost any stencil reference value is valid for setStencilReference')\n  .params([\n    { value: 1 }, //\n    { value: 0 },\n    { value: 1000 },\n    { value: 0xffffffff },\n  ])\n  .fn(t => {\n    const { value } = t.params;\n    const encoders = t.createDummyRenderPassEncoder();\n    encoders.pass.setStencilReference(value);\n    encoders.pass.endPass();\n    encoders.encoder.finish();\n  });\n"],"file":"dynamic_render_state.spec.js"}