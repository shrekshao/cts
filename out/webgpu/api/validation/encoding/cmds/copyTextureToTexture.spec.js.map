{"version":3,"sources":["../../../../../../src/webgpu/api/validation/encoding/cmds/copyTextureToTexture.spec.ts"],"names":["description","makeTestGroup","kTextureFormatInfo","kTextureFormats","kCompressedTextureFormats","kDepthStencilFormats","kTextureUsages","textureDimensionAndFormatCompatible","kTextureDimensions","align","ValidationTest","F","TestCopyTextureToTexture","source","destination","copySize","isSuccess","commandEncoder","device","createCommandEncoder","copyTextureToTexture","expectValidationError","finish","GetPhysicalSubresourceSize","dimension","textureSize","format","mipLevel","virtualWidthAtLevel","Math","max","width","virtualHeightAtLevel","height","physicalWidthAtLevel","blockWidth","physicalHeightAtLevel","blockHeight","depthOrArrayLayers","g","test","desc","fn","t","validTexture","createTexture","size","usage","GPUTextureUsage","COPY_SRC","COPY_DST","errorTexture","getErrorTexture","texture","paramsSubcasesOnly","srcMismatched","dstMismatched","unimplemented","params","u","combine","beginSubcases","combineWithParams","srcLevelCount","dstLevelCount","srcCopyLevel","dstCopyLevel","unless","p","srcTexture","mipLevelCount","dstTexture","srcUsage","dstUsage","srcSampleCount","dstSampleCount","sampleCount","x","y","z","expand","srcCopyOrigin","dstCopyOrigin","copyWidth","copyHeight","kWidth","kHeight","origin","srcFormat","dstFormat","srcFormatInfo","dstFormatInfo","selectDeviceOrSkipTestCase","feature","kTextureSize","srcBaseFormat","baseFormat","dstBaseFormat","copyBoxOffsets","srcTextureSize","dstTextureSize","kMipLevelCount","srcSizeAtLevel","dstSizeAtLevel","copyOrigin","min","kFormat","copyDepth","srcCopyOriginZ","dstCopyOriginZ","copyExtentDepth","kArrayLayerCount","testTexture","sourceAspect","destinationAspect","kValidAspectsForFormat","rgba8unorm","depth24plus","depth32float","stencil8","depth16unorm","isSourceAspectValid","includes","isDestinationAspectValid","aspect","filter","texelBlockWidth","texelBlockHeight","isSuccessForCompressedFormats"],"mappings":"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","sourcesContent":["export const description = `\ncopyTextureToTexture tests.\n`;\n\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport {\n  kTextureFormatInfo,\n  kTextureFormats,\n  kCompressedTextureFormats,\n  kDepthStencilFormats,\n  kTextureUsages,\n  textureDimensionAndFormatCompatible,\n  kTextureDimensions,\n} from '../../../../capability_info.js';\nimport { align } from '../../../../util/math.js';\nimport { ValidationTest } from '../../validation_test.js';\n\nclass F extends ValidationTest {\n  TestCopyTextureToTexture(\n    source: GPUImageCopyTexture,\n    destination: GPUImageCopyTexture,\n    copySize: GPUExtent3D,\n    isSuccess: boolean\n  ): void {\n    const commandEncoder = this.device.createCommandEncoder();\n    commandEncoder.copyTextureToTexture(source, destination, copySize);\n\n    this.expectValidationError(() => {\n      commandEncoder.finish();\n    }, !isSuccess);\n  }\n\n  GetPhysicalSubresourceSize(\n    dimension: GPUTextureDimension,\n    textureSize: Required<GPUExtent3DDict>,\n    format: GPUTextureFormat,\n    mipLevel: number\n  ): Required<GPUExtent3DDict> {\n    const virtualWidthAtLevel = Math.max(textureSize.width >> mipLevel, 1);\n    const virtualHeightAtLevel = Math.max(textureSize.height >> mipLevel, 1);\n    const physicalWidthAtLevel = align(virtualWidthAtLevel, kTextureFormatInfo[format].blockWidth);\n    const physicalHeightAtLevel = align(\n      virtualHeightAtLevel,\n      kTextureFormatInfo[format].blockHeight\n    );\n\n    switch (dimension) {\n      case '1d':\n        return { width: physicalWidthAtLevel, height: 1, depthOrArrayLayers: 1 };\n      case '2d':\n        return {\n          width: physicalWidthAtLevel,\n          height: physicalHeightAtLevel,\n          depthOrArrayLayers: textureSize.depthOrArrayLayers,\n        };\n      case '3d':\n        return {\n          width: physicalWidthAtLevel,\n          height: physicalHeightAtLevel,\n          depthOrArrayLayers: Math.max(textureSize.depthOrArrayLayers >> mipLevel, 1),\n        };\n    }\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('copy_with_invalid_texture')\n  .desc('Test copyTextureToTexture is an error when one of the textures is invalid.')\n  .fn(async t => {\n    const validTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    });\n\n    const errorTexture = t.getErrorTexture();\n\n    t.TestCopyTextureToTexture(\n      { texture: errorTexture },\n      { texture: validTexture },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      false\n    );\n    t.TestCopyTextureToTexture(\n      { texture: validTexture },\n      { texture: errorTexture },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      false\n    );\n  });\n\ng.test('texture,device_mismatch')\n  .desc(\n    'Tests copyTextureToTexture cannot be called with src texture or dst texture created from another device.'\n  )\n  .paramsSubcasesOnly([\n    { srcMismatched: false, dstMismatched: false }, // control case\n    { srcMismatched: true, dstMismatched: false },\n    { srcMismatched: false, dstMismatched: true },\n  ] as const)\n  .unimplemented();\n\ng.test('mipmap_level')\n  .desc(\n    `\nTest copyTextureToTexture must specify mipLevels that are in range.\n- for various dimensions\n- for varioues mip level count in the texture\n- for various copy target mip level (in range and not in range)\n`\n  )\n  .params(u =>\n    u //\n      .combine('dimension', kTextureDimensions)\n      .beginSubcases()\n      .combineWithParams([\n        { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 0, dstCopyLevel: 0 },\n        { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 1, dstCopyLevel: 0 },\n        { srcLevelCount: 1, dstLevelCount: 1, srcCopyLevel: 0, dstCopyLevel: 1 },\n        { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 0 },\n        { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 2, dstCopyLevel: 0 },\n        { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 3, dstCopyLevel: 0 },\n        { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 2 },\n        { srcLevelCount: 3, dstLevelCount: 3, srcCopyLevel: 0, dstCopyLevel: 3 },\n      ] as const)\n      .unless(p => p.dimension === '1d' && (p.srcLevelCount !== 1 || p.dstLevelCount !== 1))\n  )\n\n  .fn(async t => {\n    const { srcLevelCount, dstLevelCount, srcCopyLevel, dstCopyLevel, dimension } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 32, height: 1, depthOrArrayLayers: 1 },\n      dimension,\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      mipLevelCount: srcLevelCount,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 32, height: 1, depthOrArrayLayers: 1 },\n      dimension,\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      mipLevelCount: dstLevelCount,\n    });\n\n    const isSuccess = srcCopyLevel < srcLevelCount && dstCopyLevel < dstLevelCount;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, mipLevel: srcCopyLevel },\n      { texture: dstTexture, mipLevel: dstCopyLevel },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('texture_usage')\n  .desc(\n    `\nTest that copyTextureToTexture source/destination need COPY_SRC/COPY_DST usages.\n- for all possible source texture usages\n- for all possible destination texture usages\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('srcUsage', kTextureUsages)\n      .combine('dstUsage', kTextureUsages)\n  )\n  .fn(async t => {\n    const { srcUsage, dstUsage } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: srcUsage,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: dstUsage,\n    });\n\n    const isSuccess =\n      srcUsage === GPUTextureUsage.COPY_SRC && dstUsage === GPUTextureUsage.COPY_DST;\n\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      { width: 1, height: 1, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('sample_count')\n  .desc(\n    `\nTest that textures in copyTextureToTexture must have the same sample count.\n- for various source texture sample count\n- for various destination texture sample count\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('srcSampleCount', [1, 4])\n      .combine('dstSampleCount', [1, 4])\n  )\n  .fn(async t => {\n    const { srcSampleCount, dstSampleCount } = t.params;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      sampleCount: srcSampleCount,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: 4, height: 4, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      sampleCount: dstSampleCount,\n    });\n\n    const isSuccess = srcSampleCount === dstSampleCount;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      { width: 4, height: 4, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('multisampled_copy_restrictions')\n  .desc(\n    `\nTest that copyTextureToTexture of multisampled texture must copy a whole subresource to a whole subresource.\n- for various origin for the source and destination of the copies.\n\nNote: this is only tested for 2D textures as it is the only dimension compatible with multisampling.\nTODO: Check the source and destination constraints separately.\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('srcCopyOrigin', [\n        { x: 0, y: 0, z: 0 },\n        { x: 1, y: 0, z: 0 },\n        { x: 0, y: 1, z: 0 },\n        { x: 1, y: 1, z: 0 },\n      ])\n      .combine('dstCopyOrigin', [\n        { x: 0, y: 0, z: 0 },\n        { x: 1, y: 0, z: 0 },\n        { x: 0, y: 1, z: 0 },\n        { x: 1, y: 1, z: 0 },\n      ])\n      .expand('copyWidth', p => [32 - Math.max(p.srcCopyOrigin.x, p.dstCopyOrigin.x), 16])\n      .expand('copyHeight', p => [16 - Math.max(p.srcCopyOrigin.y, p.dstCopyOrigin.y), 8])\n  )\n  .fn(async t => {\n    const { srcCopyOrigin, dstCopyOrigin, copyWidth, copyHeight } = t.params;\n\n    const kWidth = 32;\n    const kHeight = 16;\n\n    // Currently we don't support multisampled 2D array textures and the mipmap level count of the\n    // multisampled textures must be 1.\n    const srcTexture = t.device.createTexture({\n      size: { width: kWidth, height: kHeight, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC,\n      sampleCount: 4,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: kWidth, height: kHeight, depthOrArrayLayers: 1 },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_DST,\n      sampleCount: 4,\n    });\n\n    const isSuccess = copyWidth === kWidth && copyHeight === kHeight;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: srcCopyOrigin },\n      { texture: dstTexture, origin: dstCopyOrigin },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('texture_format_compatibility')\n  .desc(\n    `\nTest the formats of textures in copyTextureToTexture must be copy-compatible.\n- for all source texture formats\n- for all destination texture formats\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('srcFormat', kTextureFormats)\n      .combine('dstFormat', kTextureFormats)\n  )\n  .fn(async t => {\n    const { srcFormat, dstFormat } = t.params;\n    const srcFormatInfo = kTextureFormatInfo[srcFormat];\n    const dstFormatInfo = kTextureFormatInfo[dstFormat];\n    await t.selectDeviceOrSkipTestCase([srcFormatInfo.feature, dstFormatInfo.feature]);\n\n    const kTextureSize = { width: 16, height: 16, depthOrArrayLayers: 1 };\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: srcFormat,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format: dstFormat,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    // Allow copy between compatible format textures.\n    const srcBaseFormat = kTextureFormatInfo[srcFormat].baseFormat ?? srcFormat;\n    const dstBaseFormat = kTextureFormatInfo[dstFormat].baseFormat ?? dstFormat;\n    const isSuccess = srcBaseFormat === dstBaseFormat;\n\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture },\n      { texture: dstTexture },\n      kTextureSize,\n      isSuccess\n    );\n  });\n\ng.test('depth_stencil_copy_restrictions')\n  .desc(\n    `\nTest that depth textures subresources must be entirely copied in copyTextureToTexture\n- for various depth-stencil formats\n- for various copy origin and size offsets\n- for various source and destination texture sizes\n- for various source and destination mip levels\n\nNote: this is only tested for 2D textures as it is the only dimension compatible with depth-stencil.\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kDepthStencilFormats)\n      .beginSubcases()\n      .combine('copyBoxOffsets', [\n        { x: 0, y: 0, width: 0, height: 0 },\n        { x: 1, y: 0, width: 0, height: 0 },\n        { x: 0, y: 1, width: 0, height: 0 },\n        { x: 0, y: 0, width: -1, height: 0 },\n        { x: 0, y: 0, width: 0, height: -1 },\n      ])\n      .combine('srcTextureSize', [\n        { width: 64, height: 64, depthOrArrayLayers: 1 },\n        { width: 64, height: 32, depthOrArrayLayers: 1 },\n        { width: 32, height: 32, depthOrArrayLayers: 1 },\n      ])\n      .combine('dstTextureSize', [\n        { width: 64, height: 64, depthOrArrayLayers: 1 },\n        { width: 64, height: 32, depthOrArrayLayers: 1 },\n        { width: 32, height: 32, depthOrArrayLayers: 1 },\n      ])\n      .combine('srcCopyLevel', [1, 2])\n      .combine('dstCopyLevel', [0, 1])\n  )\n  .fn(async t => {\n    const {\n      format,\n      copyBoxOffsets,\n      srcTextureSize,\n      dstTextureSize,\n      srcCopyLevel,\n      dstCopyLevel,\n    } = t.params;\n    await t.selectDeviceOrSkipTestCase(kTextureFormatInfo[format].feature);\n\n    const kMipLevelCount = 3;\n\n    const srcTexture = t.device.createTexture({\n      size: { width: srcTextureSize.width, height: srcTextureSize.height, depthOrArrayLayers: 1 },\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: { width: dstTextureSize.width, height: dstTextureSize.height, depthOrArrayLayers: 1 },\n      format,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize('2d', srcTextureSize, format, srcCopyLevel);\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize('2d', dstTextureSize, format, dstCopyLevel);\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: 0 };\n\n    const copyWidth =\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x;\n    const copyHeight =\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y;\n\n    // Depth/stencil copies must copy whole subresources.\n    const isSuccess =\n      copyOrigin.x === 0 &&\n      copyOrigin.y === 0 &&\n      copyWidth === srcSizeAtLevel.width &&\n      copyHeight === srcSizeAtLevel.height &&\n      copyWidth === dstSizeAtLevel.width &&\n      copyHeight === dstSizeAtLevel.height;\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n      { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n      { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n      { width: copyWidth, height: copyHeight, depthOrArrayLayers: 1 },\n      isSuccess\n    );\n  });\n\ng.test('copy_ranges')\n  .desc(\n    `\nTest that copyTextureToTexture copy boxes must be in range of the subresource.\n- for various dimensions\n- for various offsets to a full copy for the copy origin/size\n- for various copy mip levels\n`\n  )\n  .params(u =>\n    u\n      .combine('dimension', kTextureDimensions)\n      //.beginSubcases()\n      .combine('copyBoxOffsets', [\n        { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 1, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 1, y: 0, z: 0, width: -1, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 1, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 1, z: 0, width: 0, height: -1, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 1, width: 0, height: 1, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 2, width: 0, height: 1, depthOrArrayLayers: 0 },\n        { x: 0, y: 0, z: 0, width: 1, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: 0, height: 1, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 1 },\n        { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 0 },\n        { x: 0, y: 0, z: 1, width: 0, height: 0, depthOrArrayLayers: -1 },\n        { x: 0, y: 0, z: 2, width: 0, height: 0, depthOrArrayLayers: -1 },\n      ])\n      .unless(\n        p =>\n          p.dimension === '1d' &&\n          (p.copyBoxOffsets.y !== 0 ||\n            p.copyBoxOffsets.z !== 0 ||\n            p.copyBoxOffsets.height !== 0 ||\n            p.copyBoxOffsets.depthOrArrayLayers !== 0)\n      )\n      .combine('srcCopyLevel', [0, 1, 3])\n      .combine('dstCopyLevel', [0, 1, 3])\n      .unless(p => p.dimension === '1d' && (p.srcCopyLevel !== 0 || p.dstCopyLevel !== 0))\n  )\n  .fn(async t => {\n    const { dimension, copyBoxOffsets, srcCopyLevel, dstCopyLevel } = t.params;\n\n    const textureSize = { width: 16, height: 8, depthOrArrayLayers: 3 };\n    let mipLevelCount = 4;\n    if (dimension === '1d') {\n      mipLevelCount = 1;\n      textureSize.height = 1;\n      textureSize.depthOrArrayLayers = 1;\n    }\n    const kFormat = 'rgba8unorm';\n\n    const srcTexture = t.device.createTexture({\n      size: textureSize,\n      format: kFormat,\n      dimension,\n      mipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: textureSize,\n      format: kFormat,\n      dimension,\n      mipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize(\n      dimension,\n      textureSize,\n      kFormat,\n      srcCopyLevel\n    );\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize(\n      dimension,\n      textureSize,\n      kFormat,\n      dstCopyLevel\n    );\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: copyBoxOffsets.z };\n\n    const copyWidth = Math.max(\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x,\n      0\n    );\n    const copyHeight = Math.max(\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y,\n      0\n    );\n    const copyDepth =\n      textureSize.depthOrArrayLayers + copyBoxOffsets.depthOrArrayLayers - copyOrigin.z;\n\n    {\n      let isSuccess =\n        copyWidth <= srcSizeAtLevel.width &&\n        copyHeight <= srcSizeAtLevel.height &&\n        copyOrigin.x + copyWidth <= dstSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= dstSizeAtLevel.height;\n\n      if (dimension === '3d') {\n        isSuccess =\n          isSuccess &&\n          copyDepth <= srcSizeAtLevel.depthOrArrayLayers &&\n          copyOrigin.z + copyDepth <= dstSizeAtLevel.depthOrArrayLayers;\n      } else {\n        isSuccess =\n          isSuccess &&\n          copyDepth <= textureSize.depthOrArrayLayers &&\n          copyOrigin.z + copyDepth <= textureSize.depthOrArrayLayers;\n      }\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n\n    {\n      let isSuccess =\n        copyOrigin.x + copyWidth <= srcSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= srcSizeAtLevel.height &&\n        copyWidth <= dstSizeAtLevel.width &&\n        copyHeight <= dstSizeAtLevel.height;\n\n      if (dimension === '3d') {\n        isSuccess =\n          isSuccess &&\n          copyDepth <= dstSizeAtLevel.depthOrArrayLayers &&\n          copyOrigin.z + copyDepth <= srcSizeAtLevel.depthOrArrayLayers;\n      } else {\n        isSuccess =\n          isSuccess &&\n          copyDepth <= textureSize.depthOrArrayLayers &&\n          copyOrigin.z + copyDepth <= textureSize.depthOrArrayLayers;\n      }\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n  });\n\ng.test('copy_within_same_texture')\n  .desc(\n    `\nTest that it is an error to use copyTextureToTexture from one subresource to itself.\n- for various starting source/destination array layers.\n- for various copy sizes in number of array layers\n\nTODO: Extend to check the copy is allowed between different mip levels.\nTODO: Extend to 1D and 3D textures.`\n  )\n  .paramsSubcasesOnly(u =>\n    u //\n      .combine('srcCopyOriginZ', [0, 2, 4])\n      .combine('dstCopyOriginZ', [0, 2, 4])\n      .combine('copyExtentDepth', [1, 2, 3])\n  )\n  .fn(async t => {\n    const { srcCopyOriginZ, dstCopyOriginZ, copyExtentDepth } = t.params;\n\n    const kArrayLayerCount = 7;\n\n    const testTexture = t.device.createTexture({\n      size: { width: 16, height: 16, depthOrArrayLayers: kArrayLayerCount },\n      format: 'rgba8unorm',\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.COPY_DST,\n    });\n\n    const isSuccess =\n      Math.min(srcCopyOriginZ, dstCopyOriginZ) + copyExtentDepth <=\n      Math.max(srcCopyOriginZ, dstCopyOriginZ);\n    t.TestCopyTextureToTexture(\n      { texture: testTexture, origin: { x: 0, y: 0, z: srcCopyOriginZ } },\n      { texture: testTexture, origin: { x: 0, y: 0, z: dstCopyOriginZ } },\n      { width: 16, height: 16, depthOrArrayLayers: copyExtentDepth },\n      isSuccess\n    );\n  });\n\ng.test('copy_aspects')\n  .desc(\n    `\nTest the validations on the member 'aspect' of GPUImageCopyTexture in CopyTextureToTexture().\n- for all the color and depth-stencil formats: the texture copy aspects must be both 'all'.\n- for all the depth-only formats: the texture copy aspects must be either 'all' or 'depth-only'.\n- for all the stencil-only formats: the texture copy aspects must be either 'all' or 'stencil-only'.\n`\n  )\n  .params(u =>\n    u\n      .combine('format', ['rgba8unorm', ...kDepthStencilFormats] as const)\n      .beginSubcases()\n      .combine('sourceAspect', ['all', 'depth-only', 'stencil-only'] as const)\n      .combine('destinationAspect', ['all', 'depth-only', 'stencil-only'] as const)\n  )\n  .fn(async t => {\n    const { format, sourceAspect, destinationAspect } = t.params;\n    await t.selectDeviceOrSkipTestCase(kTextureFormatInfo[format].feature);\n\n    const kTextureSize = { width: 16, height: 8, depthOrArrayLayers: 1 };\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    // MAINTENANCE_TODO: get the valid aspects from capability_info.ts.\n    const kValidAspectsForFormat = {\n      rgba8unorm: ['all'],\n\n      // kUnsizedDepthStencilFormats\n      depth24plus: ['all', 'depth-only'],\n      'depth24plus-stencil8': ['all'],\n      'depth24unorm-stencil8': ['all'],\n      'depth32float-stencil8': ['all'],\n\n      // kSizedDepthStencilFormats\n      depth32float: ['all', 'depth-only'],\n      stencil8: ['all', 'stencil-only'],\n      depth16unorm: ['all', 'depth-only'],\n    };\n\n    const isSourceAspectValid = kValidAspectsForFormat[format].includes(sourceAspect);\n    const isDestinationAspectValid = kValidAspectsForFormat[format].includes(destinationAspect);\n\n    t.TestCopyTextureToTexture(\n      { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, aspect: sourceAspect },\n      { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, aspect: destinationAspect },\n      kTextureSize,\n      isSourceAspectValid && isDestinationAspectValid\n    );\n  });\n\ng.test('copy_ranges_with_compressed_texture_formats')\n  .desc(\n    `\nTest that copyTextureToTexture copy boxes must be in range of the subresource and aligned to the block size\n- for various dimensions\n- for various offsets to a full copy for the copy origin/size\n- for various copy mip levels\n\nTODO: Express the offsets in \"block size\" so as to be able to test non-4x4 compressed formats\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kCompressedTextureFormats)\n      .combine('dimension', kTextureDimensions)\n      .filter(({ dimension, format }) => textureDimensionAndFormatCompatible(dimension, format))\n      .beginSubcases()\n      .combine('copyBoxOffsets', [\n        { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 1, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 4, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: -1, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: -4, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 1, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 4, z: 0, width: 0, height: 0, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: 0, height: -1, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: 0, height: -4, depthOrArrayLayers: -2 },\n        { x: 0, y: 0, z: 0, width: 0, height: 0, depthOrArrayLayers: 0 },\n        { x: 0, y: 0, z: 1, width: 0, height: 0, depthOrArrayLayers: -1 },\n      ])\n      .combine('srcCopyLevel', [0, 1, 2])\n      .combine('dstCopyLevel', [0, 1, 2])\n  )\n  .fn(async t => {\n    const { format, dimension, copyBoxOffsets, srcCopyLevel, dstCopyLevel } = t.params;\n    await t.selectDeviceOrSkipTestCase(kTextureFormatInfo[format].feature);\n    const { blockWidth, blockHeight } = kTextureFormatInfo[format];\n\n    const kTextureSize = {\n      width: 15 * blockWidth,\n      height: 12 * blockHeight,\n      depthOrArrayLayers: 3,\n    };\n    const kMipLevelCount = 4;\n\n    const srcTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      dimension,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_SRC,\n    });\n    const dstTexture = t.device.createTexture({\n      size: kTextureSize,\n      format,\n      dimension,\n      mipLevelCount: kMipLevelCount,\n      usage: GPUTextureUsage.COPY_DST,\n    });\n\n    const srcSizeAtLevel = t.GetPhysicalSubresourceSize(\n      dimension,\n      kTextureSize,\n      format,\n      srcCopyLevel\n    );\n    const dstSizeAtLevel = t.GetPhysicalSubresourceSize(\n      dimension,\n      kTextureSize,\n      format,\n      dstCopyLevel\n    );\n\n    const copyOrigin = { x: copyBoxOffsets.x, y: copyBoxOffsets.y, z: copyBoxOffsets.z };\n\n    const copyWidth = Math.max(\n      Math.min(srcSizeAtLevel.width, dstSizeAtLevel.width) + copyBoxOffsets.width - copyOrigin.x,\n      0\n    );\n    const copyHeight = Math.max(\n      Math.min(srcSizeAtLevel.height, dstSizeAtLevel.height) + copyBoxOffsets.height - copyOrigin.y,\n      0\n    );\n    const copyDepth =\n      kTextureSize.depthOrArrayLayers + copyBoxOffsets.depthOrArrayLayers - copyOrigin.z;\n\n    const texelBlockWidth = kTextureFormatInfo[format].blockWidth;\n    const texelBlockHeight = kTextureFormatInfo[format].blockHeight;\n\n    const isSuccessForCompressedFormats =\n      copyOrigin.x % texelBlockWidth === 0 &&\n      copyOrigin.y % texelBlockHeight === 0 &&\n      copyWidth % texelBlockWidth === 0 &&\n      copyHeight % texelBlockHeight === 0;\n\n    {\n      const isSuccess =\n        isSuccessForCompressedFormats &&\n        copyWidth <= srcSizeAtLevel.width &&\n        copyHeight <= srcSizeAtLevel.height &&\n        copyOrigin.x + copyWidth <= dstSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: copyOrigin, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n\n    {\n      const isSuccess =\n        isSuccessForCompressedFormats &&\n        copyOrigin.x + copyWidth <= srcSizeAtLevel.width &&\n        copyOrigin.y + copyHeight <= srcSizeAtLevel.height &&\n        copyWidth <= dstSizeAtLevel.width &&\n        copyHeight <= dstSizeAtLevel.height &&\n        copyOrigin.z + copyDepth <= kTextureSize.depthOrArrayLayers;\n\n      t.TestCopyTextureToTexture(\n        { texture: srcTexture, origin: copyOrigin, mipLevel: srcCopyLevel },\n        { texture: dstTexture, origin: { x: 0, y: 0, z: 0 }, mipLevel: dstCopyLevel },\n        { width: copyWidth, height: copyHeight, depthOrArrayLayers: copyDepth },\n        isSuccess\n      );\n    }\n  });\n"],"file":"copyTextureToTexture.spec.js"}