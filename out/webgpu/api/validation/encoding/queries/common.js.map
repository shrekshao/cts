{"version":3,"sources":["../../../../../../src/webgpu/api/validation/encoding/queries/common.ts"],"names":["createQuerySetWithType","t","type","count","device","createQuerySet","pipelineStatistics","beginRenderPassWithQuerySet","encoder","querySet","view","createTexture","format","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","RENDER_ATTACHMENT","createView","beginRenderPass","colorAttachments","loadValue","r","g","b","a","storeOp","occlusionQuerySet","createRenderEncoderWithQuerySet","commandEncoder","createCommandEncoder","finish","endPass"],"mappings":";AAAA;AACA;AAEA,OAAO,SAASA,sBAAT;AACLC,CADK;AAELC,IAFK;AAGLC,KAHK;AAIQ;AACb,SAAOF,CAAC,CAACG,MAAF,CAASC,cAAT,CAAwB;AAC7BH,IAAAA,IAD6B;AAE7BC,IAAAA,KAF6B;AAG7BG,IAAAA,kBAAkB;AAChBJ,IAAAA,IAAI,KAAK,qBAAT,GAAkC,CAAC,qBAAD,CAAlC,GAAuE,EAJ5C,EAAxB,CAAP;;AAMD;;AAED,OAAO,SAASK,2BAAT;AACLN,CADK;AAELO,OAFK;AAGLC,QAHK;AAIiB;AACtB,QAAMC,IAAI,GAAGT,CAAC,CAACG,MAAF;AACVO,EAAAA,aADU,CACI;AACbC,IAAAA,MAAM,EAAE,YADK;AAEbC,IAAAA,IAAI,EAAE,EAAEC,KAAK,EAAE,EAAT,EAAaC,MAAM,EAAE,EAArB,EAAyBC,kBAAkB,EAAE,CAA7C,EAFO;AAGbC,IAAAA,KAAK,EAAEC,eAAe,CAACC,iBAHV,EADJ;;AAMVC,EAAAA,UANU,EAAb;AAOA,SAAOZ,OAAO,CAACa,eAAR,CAAwB;AAC7BC,IAAAA,gBAAgB,EAAE;AAChB;AACEZ,MAAAA,IADF;AAEEa,MAAAA,SAAS,EAAE,EAAEC,CAAC,EAAE,GAAL,EAAUC,CAAC,EAAE,GAAb,EAAkBC,CAAC,EAAE,GAArB,EAA0BC,CAAC,EAAE,GAA7B,EAFb;AAGEC,MAAAA,OAAO,EAAE,OAHX,EADgB,CADW;;;AAQ7BC,IAAAA,iBAAiB,EAAEpB,QARU,EAAxB,CAAP;;AAUD;;AAED,OAAO,SAASqB,+BAAT;AACL7B,CADK;AAELQ,QAFK;AAG8B;AACnC,QAAMsB,cAAc,GAAG9B,CAAC,CAACG,MAAF,CAAS4B,oBAAT,EAAvB;AACA,QAAMxB,OAAO,GAAGD,2BAA2B,CAACN,CAAD,EAAI8B,cAAJ,EAAoBtB,QAApB,CAA3C;AACA,SAAO;AACLD,IAAAA,OADK;AAELyB,IAAAA,MAAM,EAAE,MAAM;AACZzB,MAAAA,OAAO,CAAC0B,OAAR;AACA,aAAOH,cAAc,CAACE,MAAf,EAAP;AACD,KALI,EAAP;;AAOD","sourcesContent":["import { GPUTest } from '../../../../gpu_test.js';\nimport { CommandBufferMaker } from '../../validation_test.js';\n\nexport function createQuerySetWithType(\n  t: GPUTest,\n  type: GPUQueryType,\n  count: GPUSize32\n): GPUQuerySet {\n  return t.device.createQuerySet({\n    type,\n    count,\n    pipelineStatistics:\n      type === 'pipeline-statistics' ? (['clipper-invocations'] as const) : ([] as const),\n  });\n}\n\nexport function beginRenderPassWithQuerySet(\n  t: GPUTest,\n  encoder: GPUCommandEncoder,\n  querySet?: GPUQuerySet\n): GPURenderPassEncoder {\n  const view = t.device\n    .createTexture({\n      format: 'rgba8unorm' as const,\n      size: { width: 16, height: 16, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.RENDER_ATTACHMENT,\n    })\n    .createView();\n  return encoder.beginRenderPass({\n    colorAttachments: [\n      {\n        view,\n        loadValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n        storeOp: 'store',\n      },\n    ],\n    occlusionQuerySet: querySet,\n  });\n}\n\nexport function createRenderEncoderWithQuerySet(\n  t: GPUTest,\n  querySet?: GPUQuerySet\n): CommandBufferMaker<'render pass'> {\n  const commandEncoder = t.device.createCommandEncoder();\n  const encoder = beginRenderPassWithQuerySet(t, commandEncoder, querySet);\n  return {\n    encoder,\n    finish: () => {\n      encoder.endPass();\n      return commandEncoder.finish();\n    },\n  } as const;\n}\n"],"file":"common.js"}