{"version":3,"sources":["../../../../../../src/webgpu/api/validation/queue/destroyed/query_set.spec.ts"],"names":["description","makeTestGroup","ValidationTest","g","test","desc","paramsSubcasesOnly","u","combine","fn","t","occlusionQuerySet","createQuerySetWithState","params","querySetState","encoder","createEncoder","beginOcclusionQuery","endOcclusionQuery","validateFinishAndSubmitGivenState","beginSubcases","beforeAllSubcases","selectDeviceOrSkipTestCase","querySet","type","count","writeTimestamp","buffer","device","createBuffer","size","usage","GPUBufferUsage","QUERY_RESOLVE","resolveQuerySet"],"mappings":";AAAA;AACA,GADA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA,CAFO,CAIP,SAASC,aAAT,QAA8B,+CAA9B;AACA,SAASC,cAAT,QAA+B,0BAA/B;;AAEA,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,cAAD,CAAvB;;AAEPC,CAAC,CAACC,IAAF,CAAO,qBAAP;AACGC,IADH;AAEK;AACL;AACA;AACA,GALA;;AAOGC,kBAPH,CAOsB,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAF,CAAU,eAAV,EAA2B,CAAC,OAAD,EAAU,WAAV,CAA3B,CAP3B;AAQGC,EARH,CAQM,CAAAC,CAAC,KAAI;AACP,QAAMC,iBAAiB,GAAGD,CAAC,CAACE,uBAAF,CAA0BF,CAAC,CAACG,MAAF,CAASC,aAAnC,CAA1B;;AAEA,QAAMC,OAAO,GAAGL,CAAC,CAACM,aAAF,CAAgB,aAAhB,EAA+B,EAAEL,iBAAF,EAA/B,CAAhB;AACAI,EAAAA,OAAO,CAACA,OAAR,CAAgBE,mBAAhB,CAAoC,CAApC;AACAF,EAAAA,OAAO,CAACA,OAAR,CAAgBG,iBAAhB;AACAH,EAAAA,OAAO,CAACI,iCAAR,CAA0CT,CAAC,CAACG,MAAF,CAASC,aAAnD;AACD,CAfH;;AAiBAX,CAAC,CAACC,IAAF,CAAO,gBAAP;AACGC,IADH;AAEK;AACL;AACA;AACA,GALA;;AAOGQ,MAPH,CAOU,CAAAN,CAAC,KAAIA,CAAC,CAACa,aAAF,GAAkBZ,OAAlB,CAA0B,eAA1B,EAA2C,CAAC,OAAD,EAAU,WAAV,CAA3C,CAPf;AAQGa,iBARH,CAQqB,CAAAX,CAAC,KAAIA,CAAC,CAACY,0BAAF,CAA6B,iBAA7B,CAR1B;AASGb,EATH,CASM,OAAMC,CAAN,KAAW;AACb,QAAMa,QAAQ,GAAGb,CAAC,CAACE,uBAAF,CAA0BF,CAAC,CAACG,MAAF,CAASC,aAAnC,EAAkD;AACjEU,IAAAA,IAAI,EAAE,WAD2D;AAEjEC,IAAAA,KAAK,EAAE,CAF0D,EAAlD,CAAjB;;;AAKA,QAAMV,OAAO,GAAGL,CAAC,CAACM,aAAF,CAAgB,UAAhB,CAAhB;AACAD,EAAAA,OAAO,CAACA,OAAR,CAAgBW,cAAhB,CAA+BH,QAA/B,EAAyC,CAAzC;AACAR,EAAAA,OAAO,CAACI,iCAAR,CAA0CT,CAAC,CAACG,MAAF,CAASC,aAAnD;AACD,CAlBH;;AAoBAX,CAAC,CAACC,IAAF,CAAO,iBAAP;AACGC,IADH;AAEK;AACL;AACA;AACA,GALA;;AAOGC,kBAPH,CAOsB,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAF,CAAU,eAAV,EAA2B,CAAC,OAAD,EAAU,WAAV,CAA3B,CAP3B;AAQGC,EARH,CAQM,OAAMC,CAAN,KAAW;AACb,QAAMa,QAAQ,GAAGb,CAAC,CAACE,uBAAF,CAA0BF,CAAC,CAACG,MAAF,CAASC,aAAnC,CAAjB;;AAEA,QAAMa,MAAM,GAAGjB,CAAC,CAACkB,MAAF,CAASC,YAAT,CAAsB,EAAEC,IAAI,EAAE,CAAR,EAAWC,KAAK,EAAEC,cAAc,CAACC,aAAjC,EAAtB,CAAf;;AAEA,QAAMlB,OAAO,GAAGL,CAAC,CAACM,aAAF,CAAgB,UAAhB,CAAhB;AACAD,EAAAA,OAAO,CAACA,OAAR,CAAgBmB,eAAhB,CAAgCX,QAAhC,EAA0C,CAA1C,EAA6C,CAA7C,EAAgDI,MAAhD,EAAwD,CAAxD;AACAZ,EAAAA,OAAO,CAACI,iCAAR,CAA0CT,CAAC,CAACG,MAAF,CAASC,aAAnD;AACD,CAhBH","sourcesContent":["export const description = `\nTests using a destroyed query set on a queue.\n`;\n\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { ValidationTest } from '../../validation_test.js';\n\nexport const g = makeTestGroup(ValidationTest);\n\ng.test('beginOcclusionQuery')\n  .desc(\n    `\nTests that use a destroyed query set in occlusion query on render pass encoder.\n- x= {destroyed, not destroyed (control case)}\n  `\n  )\n  .paramsSubcasesOnly(u => u.combine('querySetState', ['valid', 'destroyed'] as const))\n  .fn(t => {\n    const occlusionQuerySet = t.createQuerySetWithState(t.params.querySetState);\n\n    const encoder = t.createEncoder('render pass', { occlusionQuerySet });\n    encoder.encoder.beginOcclusionQuery(0);\n    encoder.encoder.endOcclusionQuery();\n    encoder.validateFinishAndSubmitGivenState(t.params.querySetState);\n  });\n\ng.test('writeTimestamp')\n  .desc(\n    `\nTests that use a destroyed query set in writeTimestamp on {non-pass, compute, render} encoder.\n- x= {destroyed, not destroyed (control case)}\n  `\n  )\n  .params(u => u.beginSubcases().combine('querySetState', ['valid', 'destroyed'] as const))\n  .beforeAllSubcases(t => t.selectDeviceOrSkipTestCase('timestamp-query'))\n  .fn(async t => {\n    const querySet = t.createQuerySetWithState(t.params.querySetState, {\n      type: 'timestamp',\n      count: 2,\n    });\n\n    const encoder = t.createEncoder('non-pass');\n    encoder.encoder.writeTimestamp(querySet, 0);\n    encoder.validateFinishAndSubmitGivenState(t.params.querySetState);\n  });\n\ng.test('resolveQuerySet')\n  .desc(\n    `\nTests that use a destroyed query set in resolveQuerySet.\n- x= {destroyed, not destroyed (control case)}\n  `\n  )\n  .paramsSubcasesOnly(u => u.combine('querySetState', ['valid', 'destroyed'] as const))\n  .fn(async t => {\n    const querySet = t.createQuerySetWithState(t.params.querySetState);\n\n    const buffer = t.device.createBuffer({ size: 8, usage: GPUBufferUsage.QUERY_RESOLVE });\n\n    const encoder = t.createEncoder('non-pass');\n    encoder.encoder.resolveQuerySet(querySet, 0, 1, buffer, 0);\n    encoder.validateFinishAndSubmitGivenState(t.params.querySetState);\n  });\n"],"file":"query_set.spec.js"}