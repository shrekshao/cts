{"version":3,"file":"configure.spec.js","names":["description","makeTestGroup","assert","kAllTextureFormats","kCanvasTextureFormats","kTextureUsages","GPUConst","GPUTest","kAllCanvasTypes","createCanvas","g","test","desc","params","u","combine","fn","t","canvasType","canvas","ctx","getContext","GPUCanvasContext","configure","device","format","currentTexture","getCurrentTexture","expect","usage","GPUTextureUsage","RENDER_ATTACHMENT","dimension","width","height","depthOrArrayLayers","mipLevelCount","sampleCount","shouldThrow","unconfigure","beforeAllSubcases","selectDeviceForTextureFormatOrSkipTestCase","validFormat","canvasFormat","expectValidationError","GPUTexture","beginSubcases","expand","p","usageSet","Set","usage0","usage1","add","TextureUsage","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","createView","clearValue","loadOp","storeOp","end","queue","submit","finish","TEXTURE_BINDING","bgl","createBindGroupLayout","entries","binding","visibility","GPUShaderStage","FRAGMENT","texture","createBindGroup","layout","resource","STORAGE_BINDING","storageTexture","access","COPY_DST","rgbaData","Uint8Array","writeTexture","COPY_SRC","size","dstTexture","createTexture","copyTextureToTexture","alphaMode"],"sources":["../../../../src/webgpu/web_platform/canvas/configure.spec.ts"],"sourcesContent":["export const description = `\nTests for GPUCanvasContext.configure.\n\nTODO:\n- Test colorSpace\n- Test viewFormats\n`;\n\nimport { makeTestGroup } from '../../../common/framework/test_group.js';\nimport { assert } from '../../../common/util/util.js';\nimport {\n  kAllTextureFormats,\n  kCanvasTextureFormats,\n  kTextureUsages,\n} from '../../capability_info.js';\nimport { GPUConst } from '../../constants.js';\nimport { GPUTest } from '../../gpu_test.js';\nimport { kAllCanvasTypes, createCanvas } from '../../util/create_elements.js';\n\nexport const g = makeTestGroup(GPUTest);\n\ng.test('defaults')\n  .desc(\n    `\n    Ensure that the defaults for GPUCanvasConfiguration are correct.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('canvasType', kAllCanvasTypes)\n  )\n  .fn(async t => {\n    const { canvasType } = t.params;\n    const canvas = createCanvas(t, canvasType, 2, 2);\n    const ctx = canvas.getContext('webgpu');\n    assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n    ctx.configure({\n      device: t.device,\n      format: 'rgba8unorm',\n    });\n\n    const currentTexture = ctx.getCurrentTexture();\n    t.expect(currentTexture.format === 'rgba8unorm');\n    t.expect(currentTexture.usage === GPUTextureUsage.RENDER_ATTACHMENT);\n    t.expect(currentTexture.dimension === '2d');\n    t.expect(currentTexture.width === canvas.width);\n    t.expect(currentTexture.height === canvas.height);\n    t.expect(currentTexture.depthOrArrayLayers === 1);\n    t.expect(currentTexture.mipLevelCount === 1);\n    t.expect(currentTexture.sampleCount === 1);\n  });\n\ng.test('device')\n  .desc(\n    `\n    Ensure that configure reacts appropriately to various device states.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('canvasType', kAllCanvasTypes)\n  )\n  .fn(async t => {\n    const { canvasType } = t.params;\n    const canvas = createCanvas(t, canvasType, 2, 2);\n    const ctx = canvas.getContext('webgpu');\n    assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n    // Calling configure without a device should throw.\n    t.shouldThrow(true, () => {\n      ctx.configure({\n        format: 'rgba8unorm',\n      } as GPUCanvasConfiguration);\n    });\n\n    // Device is not configured, so getCurrentTexture will throw.\n    t.shouldThrow(true, () => {\n      ctx.getCurrentTexture();\n    });\n\n    // Calling configure with a device should succeed.\n    ctx.configure({\n      device: t.device,\n      format: 'rgba8unorm',\n    });\n\n    // getCurrentTexture will succeed with a valid device.\n    ctx.getCurrentTexture();\n\n    // Unconfiguring should cause the device to be cleared.\n    ctx.unconfigure();\n    t.shouldThrow(true, () => {\n      ctx.getCurrentTexture();\n    });\n\n    // Should be able to successfully configure again after unconfiguring.\n    ctx.configure({\n      device: t.device,\n      format: 'rgba8unorm',\n    });\n    ctx.getCurrentTexture();\n  });\n\ng.test('format')\n  .desc(\n    `\n    Ensure that only valid texture formats are allowed when calling configure.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('canvasType', kAllCanvasTypes)\n      .combine('format', kAllTextureFormats)\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { canvasType, format } = t.params;\n    const canvas = createCanvas(t, canvasType, 2, 2);\n    const ctx = canvas.getContext('webgpu');\n    assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n    // Would prefer to use kCanvasTextureFormats.includes(format), but that's giving TS errors.\n    let validFormat = false;\n    for (const canvasFormat of kCanvasTextureFormats) {\n      if (format === canvasFormat) {\n        validFormat = true;\n        break;\n      }\n    }\n\n    t.expectValidationError(() => {\n      ctx.configure({\n        device: t.device,\n        format,\n      });\n    }, !validFormat);\n\n    t.expectValidationError(() => {\n      // Should always return a texture, whether the configured format was valid or not.\n      const currentTexture = ctx.getCurrentTexture();\n      t.expect(currentTexture instanceof GPUTexture);\n    }, !validFormat);\n  });\n\ng.test('usage')\n  .desc(\n    `\n    Ensure that getCurrentTexture returns a texture with the configured usages.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('canvasType', kAllCanvasTypes)\n      .beginSubcases()\n      .expand('usage', p => {\n        const usageSet = new Set<number>();\n        for (const usage0 of kTextureUsages) {\n          for (const usage1 of kTextureUsages) {\n            usageSet.add(usage0 | usage1);\n          }\n        }\n        return usageSet;\n      })\n  )\n  .fn(async t => {\n    const { canvasType, usage } = t.params;\n    const canvas = createCanvas(t, canvasType, 2, 2);\n    const ctx = canvas.getContext('webgpu');\n    assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n    ctx.configure({\n      device: t.device,\n      format: 'rgba8unorm',\n      usage,\n    });\n\n    const currentTexture = ctx.getCurrentTexture();\n    t.expect(currentTexture instanceof GPUTexture);\n    t.expect(currentTexture.usage === usage);\n\n    // Try to use the texture with the given usage\n\n    if (usage & GPUConst.TextureUsage.RENDER_ATTACHMENT) {\n      const encoder = t.device.createCommandEncoder();\n      const pass = encoder.beginRenderPass({\n        colorAttachments: [\n          {\n            view: currentTexture.createView(),\n            clearValue: [1.0, 0.0, 0.0, 1.0],\n            loadOp: 'clear',\n            storeOp: 'store',\n          },\n        ],\n      });\n      pass.end();\n      t.device.queue.submit([encoder.finish()]);\n    }\n\n    if (usage & GPUConst.TextureUsage.TEXTURE_BINDING) {\n      const bgl = t.device.createBindGroupLayout({\n        entries: [\n          {\n            binding: 0,\n            visibility: GPUShaderStage.FRAGMENT,\n            texture: {},\n          },\n        ],\n      });\n\n      t.device.createBindGroup({\n        layout: bgl,\n        entries: [\n          {\n            binding: 0,\n            resource: currentTexture.createView(),\n          },\n        ],\n      });\n    }\n\n    if (usage & GPUConst.TextureUsage.STORAGE_BINDING) {\n      const bgl = t.device.createBindGroupLayout({\n        entries: [\n          {\n            binding: 0,\n            visibility: GPUShaderStage.FRAGMENT,\n            storageTexture: { access: 'write-only', format: currentTexture.format },\n          },\n        ],\n      });\n\n      t.device.createBindGroup({\n        layout: bgl,\n        entries: [\n          {\n            binding: 0,\n            resource: currentTexture.createView(),\n          },\n        ],\n      });\n    }\n\n    if (usage & GPUConst.TextureUsage.COPY_DST) {\n      const rgbaData = new Uint8Array([255, 0, 0, 255]);\n\n      t.device.queue.writeTexture({ texture: currentTexture }, rgbaData, {}, [1, 1, 1]);\n    }\n\n    if (usage & GPUConst.TextureUsage.COPY_SRC) {\n      const size = [currentTexture.width, currentTexture.height, 1];\n      const dstTexture = t.device.createTexture({\n        format: currentTexture.format,\n        usage: GPUTextureUsage.COPY_DST,\n        size,\n      });\n\n      const encoder = t.device.createCommandEncoder();\n      encoder.copyTextureToTexture({ texture: currentTexture }, { texture: dstTexture }, size);\n      t.device.queue.submit([encoder.finish()]);\n    }\n  });\n\ng.test('alpha_mode')\n  .desc(\n    `\n    Ensure that all valid alphaMode values are allowed when calling configure.\n    `\n  )\n  .params(u =>\n    u //\n      .combine('canvasType', kAllCanvasTypes)\n      .beginSubcases()\n      .combine('alphaMode', ['opaque', 'premultiplied'] as const)\n  )\n  .fn(async t => {\n    const { canvasType, alphaMode } = t.params;\n    const canvas = createCanvas(t, canvasType, 2, 2);\n    const ctx = canvas.getContext('webgpu');\n    assert(ctx instanceof GPUCanvasContext, 'Failed to get WebGPU context from canvas');\n\n    ctx.configure({\n      device: t.device,\n      format: 'rgba8unorm',\n      alphaMode,\n    });\n\n    const currentTexture = ctx.getCurrentTexture();\n    t.expect(currentTexture instanceof GPUTexture);\n  });\n"],"mappings":"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"}