{"version":3,"file":"for.spec.js","names":["description","makeTestGroup","GPUTest","runFlowControlTest","g","test","desc","fn","t","f","expect_order","value","expect_not_reached","entrypoint","extra"],"sources":["../../../../../src/webgpu/shader/execution/flow_control/for.spec.ts"],"sourcesContent":["export const description = `\nFlow control tests for for-loops.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { GPUTest } from '../../../gpu_test.js';\n\nimport { runFlowControlTest } from './harness.js';\n\nexport const g = makeTestGroup(GPUTest);\n\ng.test('for_basic')\n  .desc('Test that flow control executes a for-loop body the correct number of times')\n  .fn(t => {\n    runFlowControlTest(\n      t,\n      f =>\n        `\n  ${f.expect_order(0)}\n  for (var i = ${f.value(0)}; i < ${f.value(3)}; i++) {\n    ${f.expect_order(1, 2, 3)}\n  }\n  ${f.expect_order(4)}\n`\n    );\n  });\n\ng.test('for_break')\n  .desc('Test that flow control exits a for-loop when reaching a break statement')\n  .fn(t => {\n    runFlowControlTest(\n      t,\n      f =>\n        `\n  ${f.expect_order(0)}\n  for (var i = ${f.value(0)}; i < ${f.value(5)}; i++) {\n    ${f.expect_order(1, 3, 5, 7)}\n    if (i == 3) {\n      break;\n      ${f.expect_not_reached()}\n    }\n    ${f.expect_order(2, 4, 6)}\n  }\n  ${f.expect_order(8)}\n`\n    );\n  });\n\ng.test('for_continue')\n  .desc('Test flow control for a for-loop continue statement')\n  .fn(t => {\n    runFlowControlTest(\n      t,\n      f =>\n        `\n  ${f.expect_order(0)}\n  for (var i = ${f.value(0)}; i < ${f.value(5)}; i++) {\n    ${f.expect_order(1, 3, 5, 7, 8)}\n    if (i == 3) {\n      continue;\n      ${f.expect_not_reached()}\n    }\n    ${f.expect_order(2, 4, 6, 9)}\n  }\n  ${f.expect_order(10)}\n`\n    );\n  });\n\ng.test('for_initalizer')\n  .desc('Test flow control for a for-loop initializer')\n  .fn(t => {\n    runFlowControlTest(t, f => ({\n      entrypoint: `\n  ${f.expect_order(0)}\n  for (var i = initializer(); i < ${f.value(3)}; i++) {\n    ${f.expect_order(2, 3, 4)}\n  }\n  ${f.expect_order(5)}\n`,\n      extra: `\nfn initializer() -> u32 {\n  ${f.expect_order(1)}\n  return ${f.value(0)};\n}\n      `,\n    }));\n  });\n\ng.test('for_condition')\n  .desc('Test flow control for a for-loop condition')\n  .fn(t => {\n    runFlowControlTest(t, f => ({\n      entrypoint: `\n  ${f.expect_order(0)}\n  for (var i = ${f.value(0)}; condition(i); i++) {\n    ${f.expect_order(2, 4, 6)}\n  }\n  ${f.expect_order(8)}\n`,\n      extra: `\nfn condition(i : u32) -> bool {\n  ${f.expect_order(1, 3, 5, 7)}\n  return i < ${f.value(3)};\n}\n      `,\n    }));\n  });\n\ng.test('for_continuing')\n  .desc('Test flow control for a for-loop continuing statement')\n  .fn(t => {\n    runFlowControlTest(t, f => ({\n      entrypoint: `\n  ${f.expect_order(0)}\n  for (var i = ${f.value(0)}; i < ${f.value(3)}; i = cont(i)) {\n    ${f.expect_order(1, 3, 5)}\n  }\n  ${f.expect_order(7)}\n`,\n      extra: `\nfn cont(i : u32) -> u32 {\n  ${f.expect_order(2, 4, 6)}\n  return i + 1;\n}\n      `,\n    }));\n  });\n"],"mappings":"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"}