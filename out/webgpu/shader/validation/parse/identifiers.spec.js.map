{"version":3,"file":"identifiers.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","kValidIdentifiers","Set","kInvalidIdentifiers","test","desc","params","u","combine","beginSubcases","fn","t","code","ident","expectCompileResult","has"],"sources":["../../../../../src/webgpu/shader/validation/parse/identifiers.spec.ts"],"sourcesContent":["export const description = `Validation tests for identifiers`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kValidIdentifiers = new Set([\n  'foo',\n  'Foo',\n  'FOO',\n  '_0',\n  '_foo0',\n  '_0foo',\n  'foo__0',\n  'Δέλτα',\n  'réflexion',\n  'Кызыл',\n  '𐰓𐰏𐰇',\n  '朝焼け',\n  'سلام',\n  '검정',\n  'שָׁלוֹם',\n  'गुलाबी',\n  'փիրուզ',\n]);\nconst kInvalidIdentifiers = new Set([\n  '_', // Single underscore is a syntactic token for phony assignment.\n  '__', // Leading double underscore is reserved.\n  '__foo', // Leading double underscore is reserved.\n  '0foo', // Must start with single underscore or a letter.\n  // No punctuation:\n  'foo.bar',\n  'foo-bar',\n  'foo+bar',\n  'foo#bar',\n  'foo!bar',\n  'foo\\\\bar',\n  'foo/bar',\n  'foo,bar',\n  'foo@bar',\n  'foo::bar',\n  // Keywords:\n  'array',\n  'atomic',\n  'bool',\n  'f32',\n  'f16',\n  'i32',\n  'mat2x2',\n  'mat2x3',\n  'mat2x4',\n  'mat3x2',\n  'mat3x3',\n  'mat3x4',\n  'mat4x2',\n  'mat4x3',\n  'mat4x4',\n  'override',\n  'ptr',\n  'sampler',\n  'sampler_comparison',\n  'struct',\n  'texture_1d',\n  'texture_2d',\n  'texture_2d_array',\n  'texture_3d',\n  'texture_cube',\n  'texture_cube_array',\n  'texture_multisampled_2d',\n  'texture_storage_1d',\n  'texture_storage_2d',\n  'texture_storage_2d_array',\n  'texture_storage_3d',\n  'texture_depth_2d',\n  'texture_depth_2d_array',\n  'texture_depth_cube',\n  'texture_depth_cube_array',\n  'texture_depth_multisampled_2d',\n  'u32',\n  'vec2',\n  'vec3',\n  'vec4',\n  'bitcast',\n  'break',\n  'case',\n  'const',\n  'continue',\n  'continuing',\n  'default',\n  'discard',\n  'else',\n  'enable',\n  'fallthrough',\n  'false',\n  'fn',\n  'for',\n  'function',\n  'if',\n  'let',\n  'loop',\n  'private',\n  'return',\n  'storage',\n  'switch',\n  'true',\n  'type',\n  'uniform',\n  'var',\n  'while',\n  'workgroup',\n  // Reserved Words\n  'AppendStructuredBuffer',\n  'BlendState',\n  'Buffer',\n  'ByteAddressBuffer',\n  'CompileShader',\n  'ComputeShader',\n  'ConsumeStructuredBuffer',\n  'DepthStencilState',\n  'DepthStencilView',\n  'DomainShader',\n  'GeometryShader',\n  'Hullshader',\n  'InputPatch',\n  'LineStream',\n  'NULL',\n  'OutputPatch',\n  'PixelShader',\n  'PointStream',\n  'RWBuffer',\n  'RWByteAddressBuffer',\n  'RWStructuredBuffer',\n  'RWTexture1D',\n  'RWTexture1DArray',\n  'RWTexture2D',\n  'RWTexture2DArray',\n  'RWTexture3D',\n  'RasterizerState',\n  'RenderTargetView',\n  'SamplerComparisonState',\n  'SamplerState',\n  'Self',\n  'StructuredBuffer',\n  'Texture1D',\n  'Texture1DArray',\n  'Texture2D',\n  'Texture2DArray',\n  'Texture2DMS',\n  'Texture2DMSArray',\n  'Texture3D',\n  'TextureCube',\n  'TextureCubeArray',\n  'TriangleStream',\n  'VertexShader',\n  'abstract',\n  'active',\n  'alignas',\n  'alignof',\n  'as',\n  'asm',\n  'asm_fragment',\n  'async',\n  'atomic_uint',\n  'attribute',\n  'auto',\n  'await',\n  'become',\n  'bf16',\n  'binding_array',\n  'cast',\n  'catch',\n  'cbuffer',\n  'centroid',\n  'char',\n  'class',\n  'co_await',\n  'co_return',\n  'co_yield',\n  'coherent',\n  'column_major',\n  'common',\n  'compile',\n  'compile_fragment',\n  'concept',\n  'const_cast',\n  'consteval',\n  'constexpr',\n  'constinit',\n  'crate',\n  'debugger',\n  'decltype',\n  'delete',\n  'demote',\n  'demote_to_helper',\n  'do',\n  'dword',\n  'dynamic_cast',\n  'enum',\n  'explicit',\n  'export',\n  'extends',\n  'extern',\n  'external',\n  'f64',\n  'filter',\n  'final',\n  'finally',\n  'fixed',\n  'flat',\n  'friend',\n  'from',\n  'fvec2',\n  'fvec3',\n  'fvec4',\n  'fxgroup',\n  'get',\n  'goto',\n  'groupshared',\n  'handle',\n  'highp',\n  'hvec2',\n  'hvec3',\n  'hvec4',\n  'i16',\n  'i64',\n  'i8',\n  'iimage1D',\n  'iimage1DArray',\n  'iimage2D',\n  'iimage2DArray',\n  'iimage2DMS',\n  'iimage2DMSArray',\n  'iimage2DRect',\n  'iimage3D',\n  'iimageBuffer',\n  'iimageCube',\n  'iimageCubeArray',\n  'image1D',\n  'image1DArray',\n  'image2D',\n  'image2DArray',\n  'image2DMS',\n  'image2DMSArray',\n  'image2DRect',\n  'image3D',\n  'imageBuffer',\n  'imageCube',\n  'imageCubeArray',\n  'impl',\n  'implements',\n  'import',\n  'inline',\n  'inout',\n  'instanceof',\n  'interface',\n  'invariant',\n  'isampler1D',\n  'isampler1DArray',\n  'isampler2D',\n  'isampler2DArray',\n  'isampler2DMS',\n  'isampler2DMSArray',\n  'isampler2DRect',\n  'isampler3D',\n  'isamplerBuffer',\n  'isamplerCube',\n  'isamplerCubeArray',\n  'isubpassInput',\n  'isubpassInputMS',\n  'itexture1D',\n  'itexture1DArray',\n  'itexture2D',\n  'itexture2DArray',\n  'itexture2DMS',\n  'itexture2DMSArray',\n  'itexture2DRect',\n  'itexture3D',\n  'itextureBuffer',\n  'itextureCube',\n  'itextureCubeArray',\n  'layout',\n  'linear',\n  'lowp',\n  'macro',\n  'macro_rules',\n  'mat',\n  'match',\n  'matrix',\n  'mediump',\n  'meta',\n  'mod',\n  'module',\n  'move',\n  'mut',\n  'mutable',\n  'namespace',\n  'new',\n  'nil',\n  'noexcept',\n  'noinline',\n  'nointerpolation',\n  'noperspective',\n  'null',\n  'nullptr',\n  'of',\n  'operator',\n  'package',\n  'packoffset',\n  'partition',\n  'pass',\n  'patch',\n  'pixelfragment',\n  'precise',\n  'precision',\n  'premerge',\n  'priv',\n  'protected',\n  'pub',\n  'public',\n  'readonly',\n  'ref',\n  'regardless',\n  'register',\n  'reinterpret_cast',\n  'requires',\n  'resource',\n  'restrict',\n  'row_major',\n  'samper',\n  'sample',\n  'sampler1D',\n  'sampler1DArray',\n  'sampler1DArrayShadow',\n  'sampler1DShadow',\n  'sampler2D',\n  'sampler2DArray',\n  'sampler2DArrayShadow',\n  'sampler2DMS',\n  'sampler2DMSArray',\n  'sampler2DRect',\n  'sampler2DRectShadow',\n  'sampler2DShadow',\n  'sampler3D',\n  'sampler3DRect',\n  'samplerBuffer',\n  'samplerCube',\n  'samplerCubeArray',\n  'samplerCubeArrayShadow',\n  'samplerCubeShadow',\n  'samplerShadow',\n  'self',\n  'set',\n  'shared',\n  'signed',\n  'sizeof',\n  'smooth',\n  'snorm',\n  'stateblock',\n  'stateblock_state',\n  'static',\n  'static_assert',\n  'static_cast',\n  'std',\n  'string',\n  'subpassInput',\n  'subpassInputMS',\n  'subroutine',\n  'super',\n  'superp',\n  'target',\n  'tbuffer',\n  'technique',\n  'technique10',\n  'technique11',\n  'template',\n  'texture1D',\n  'texture1DArray',\n  'texture2D',\n  'texture2DArray',\n  'texture2DMS',\n  'texture2DMSArray',\n  'texture2DRect',\n  'texture3D',\n  'textureBuffer',\n  'textureCube',\n  'textureCubeArray',\n  'this',\n  'thread_local',\n  'throw',\n  'trait',\n  'triangle',\n  'triangleadj',\n  'try',\n  'typedef',\n  'typeid',\n  'typename',\n  'typeof',\n  'u16',\n  'u64',\n  'u8',\n  'uimage1D',\n  'uimage1DArray',\n  'uimage2D',\n  'uimage2DArray',\n  'uimage2DMS',\n  'uimage2DMSArray',\n  'uimage2DRect',\n  'uimage3D',\n  'uimageBuffer',\n  'uimageCube',\n  'uimageCubeArray',\n  'union',\n  'unless',\n  'unorm',\n  'unsafe',\n  'unsigned',\n  'unsized',\n  'usampler1D',\n  'usampler1DArray',\n  'usampler2D',\n  'usampler2DArray',\n  'usampler2DMS',\n  'usampler2DMSArray',\n  'usampler2DRect',\n  'usampler3D',\n  'usamplerBuffer',\n  'usamplerCube',\n  'usamplerCubeArray',\n  'use',\n  'using',\n  'usubpassInput',\n  'usubpassInputMS',\n  'utexture1D',\n  'utexture1DArray',\n  'utexture2D',\n  'utexture2DArray',\n  'utexture2DMS',\n  'utexture2DMSArray',\n  'utexture2DRect',\n  'utexture3D',\n  'utextureBuffer',\n  'utextureCube',\n  'utextureCubeArray',\n  'varying',\n  'vec',\n  'vector',\n  'vertexfragment',\n  'virtual',\n  'void',\n  'volatile',\n  'wchar_t',\n  'wgsl',\n  'where',\n  'with',\n  'writeonly',\n  'yield',\n]);\ng.test('identifiers')\n  .desc(`Test that valid identifiers are accepted, and invalid identifiers are rejected.`)\n  .params(u =>\n    u.combine('ident', new Set([...kValidIdentifiers, ...kInvalidIdentifiers])).beginSubcases()\n  )\n  .fn(t => {\n    const code = `var<private> ${t.params.ident} : i32;`;\n    t.expectCompileResult(kValidIdentifiers.has(t.params.ident), code);\n  });\n\ng.test('non_normalized')\n  .desc(`Test that identifiers are not unicode normalized`)\n  .fn(t => {\n    const code = `var<private> \\u212b : i32;  // \\u212b normalizes with NFC to \\u00c5\nvar<private> \\u00c5 : i32;`;\n    t.expectCompileResult(true, code);\n  });\n"],"mappings":"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"}