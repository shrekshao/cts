{"version":3,"file":"align.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","kValidAlign","Set","kInvalidAlign","test","desc","params","u","combine","fn","t","v","align","replace","code","expectCompileResult","has"],"sources":["../../../../../src/webgpu/shader/validation/parse/align.spec.ts"],"sourcesContent":["export const description = `Validation tests for @align`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kValidAlign = new Set([\n  '',\n  '@align(1)',\n  '@align(4)',\n  '@align(4i)',\n  '@align(4u)',\n  '@align(0x4)',\n  '@align(4,)',\n  '@align(u_val)',\n  '@align(i_val)',\n  '@align(i_val + 4 - 6)',\n  '@align(1073741824)',\n  '@\\talign\\t(4)',\n  '@/^comment^/align/^comment^/(4)',\n]);\nconst kInvalidAlign = new Set([\n  '@malign(4)',\n  '@align()',\n  '@align 4)',\n  '@align(4',\n  '@align(4, 2)',\n  '@align(4,)',\n  '@align(3)', // Not a power of 2\n  '@align(f_val)',\n  '@align(1.0)',\n  '@align(4f)',\n  '@align(4h)',\n  '@align',\n  '@align(0)',\n  '@align(-4)',\n  '@align(2147483646)', // Not a power of 2\n  '@align(2147483648)', // Larger then max i32\n]);\n\ng.test('missing_attribute_on_param_struct')\n  .desc(`Test that @align is parsed correctly.`)\n  .params(u => u.combine('align', new Set([...kValidAlign, ...kInvalidAlign])))\n  .fn(t => {\n    const v = t.params.align.replace(/\\^/g, '*');\n    const code = `\nconst i_val: i32 = 4;\nconst u_val: u32 = 4;\nconst f_val: f32 = 4.2;\nstruct B {\n  ${v} a: i32,\n}\n\n@group(0) @binding(0)\nvar<uniform> uniform_buffer: B;\n\n@fragment\nfn main() -> @location(0) vec4<f32> {\n  return vec4<f32>(.4, .2, .3, .1);\n}`;\n    t.expectCompileResult(kValidAlign.has(t.params.align), code);\n  });\n"],"mappings":";AAAA;AAAA,GAAA,OAAO,MAAMA,WAAW,GAAI,6BAA4B,CAExD,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,oBAAoB,QAAQ,8BAA8B;;AAEnE,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,oBAAoB,CAAC;;AAEpD,MAAME,WAAW,GAAG,IAAIC,GAAG,CAAC;AAC1B,EAAE;AACF,WAAW;AACX,WAAW;AACX,YAAY;AACZ,YAAY;AACZ,aAAa;AACb,YAAY;AACZ,eAAe;AACf,eAAe;AACf,uBAAuB;AACvB,oBAAoB;AACpB,eAAe;AACf,iCAAiC,CAClC,CAAC;;AACF,MAAMC,aAAa,GAAG,IAAID,GAAG,CAAC;AAC5B,YAAY;AACZ,UAAU;AACV,WAAW;AACX,UAAU;AACV,cAAc;AACd,YAAY;AACZ,WAAW,EAAE;AACb,eAAe;AACf,aAAa;AACb,YAAY;AACZ,YAAY;AACZ,QAAQ;AACR,WAAW;AACX,YAAY;AACZ,oBAAoB,EAAE;AACtB,oBAAoB,CAAE;AAAA,CACvB,CAAC;;AAEFF,CAAC,CAACI,IAAI,CAAC,mCAAmC,CAAC;AACxCC,IAAI,CAAE,uCAAsC,CAAC;AAC7CC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,OAAO,EAAE,IAAIN,GAAG,CAAC,CAAC,GAAGD,WAAW,EAAE,GAAGE,aAAa,CAAC,CAAC,CAAC,CAAC;AAC5EM,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,CAAC,GAAGD,CAAC,CAACJ,MAAM,CAACM,KAAK,CAACC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;EAC5C,MAAMC,IAAI,GAAI;AAClB;AACA;AACA;AACA;AACA,IAAIH,CAAE;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EACED,CAAC,CAACK,mBAAmB,CAACd,WAAW,CAACe,GAAG,CAACN,CAAC,CAACJ,MAAM,CAACM,KAAK,CAAC,EAAEE,IAAI,CAAC;AAC9D,CAAC,CAAC"}