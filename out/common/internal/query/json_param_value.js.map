{"version":3,"sources":["../../../../src/common/internal/query/json_param_value.ts"],"names":["assert","sortObjectByKey","jsUndefinedMagicValue","stringifyFilter","k","v","undefined","stringifyParamValue","value","JSON","stringify","stringifyParamValueUniquely","parseParamValue","s","parse"],"mappings":";AAAA;AACA,GADA,SAASA,MAAT,EAAiBC,eAAjB,QAAwC,oBAAxC;AAGA;AACA;AACA,MAAMC,qBAAqB,GAAG,SAA9B;;AAEA,SAASC,eAAT,CAAyBC,CAAzB,EAAoCC,CAApC,EAAyD;AACvD;AACAL,EAAAA,MAAM,CAACK,CAAC,KAAKH,qBAAP,CAAN;;AAEA,SAAOG,CAAC,KAAKC,SAAN,GAAkBJ,qBAAlB,GAA0CG,CAAjD;AACD;;AAED,OAAO,SAASE,mBAAT,CAA6BC,KAA7B,EAA+D;AACpE,SAAOC,IAAI,CAACC,SAAL,CAAeF,KAAf,EAAsBL,eAAtB,CAAP;AACD;;AAED;AACA;AACA;AACA,OAAO,SAASQ,2BAAT,CAAqCH,KAArC,EAAuE;AAC5E,SAAOC,IAAI,CAACC,SAAL,CAAeF,KAAf,EAAsB,CAACJ,CAAD,EAAIC,CAAJ,KAAU;AACrC,QAAI,OAAOA,CAAP,KAAa,QAAb,IAAyBA,CAAC,KAAK,IAAnC,EAAyC;AACvC,aAAOJ,eAAe,CAACI,CAAD,CAAtB;AACD;;AAED,WAAOF,eAAe,CAACC,CAAD,EAAIC,CAAJ,CAAtB;AACD,GANM,CAAP;AAOD;;AAED,OAAO,SAASO,eAAT,CAAyBC,CAAzB,EAAuD;AAC5D,SAAOJ,IAAI,CAACK,KAAL,CAAWD,CAAX,EAAc,CAACT,CAAD,EAAIC,CAAJ,KAAWA,CAAC,KAAKH,qBAAN,GAA8BI,SAA9B,GAA0CD,CAAnE,CAAP;AACD","sourcesContent":["import { assert, sortObjectByKey } from '../../util/util.js';\nimport { JSONWithUndefined } from '../params_utils.js';\n\n// JSON can't represent `undefined` and by default stores it as `null`.\n// Instead, store `undefined` as this magic string value in JSON.\nconst jsUndefinedMagicValue = '_undef_';\n\nfunction stringifyFilter(k: string, v: unknown): unknown {\n  // Make sure no one actually uses the magic value as a parameter.\n  assert(v !== jsUndefinedMagicValue);\n\n  return v === undefined ? jsUndefinedMagicValue : v;\n}\n\nexport function stringifyParamValue(value: JSONWithUndefined): string {\n  return JSON.stringify(value, stringifyFilter);\n}\n\n/**\n * Like stringifyParamValue but sorts dictionaries by key, for hashing.\n */\nexport function stringifyParamValueUniquely(value: JSONWithUndefined): string {\n  return JSON.stringify(value, (k, v) => {\n    if (typeof v === 'object' && v !== null) {\n      return sortObjectByKey(v);\n    }\n\n    return stringifyFilter(k, v);\n  });\n}\n\nexport function parseParamValue(s: string): JSONWithUndefined {\n  return JSON.parse(s, (k, v) => (v === jsUndefinedMagicValue ? undefined : v));\n}\n"],"file":"json_param_value.js"}